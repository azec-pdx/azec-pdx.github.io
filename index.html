<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>azec.me | Blog by Amer Zec</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="azec.me | Blog by Amer Zec"><meta name="msapplication-TileImage" content="/img/favicon-128.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="azec.me | Blog by Amer Zec"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Engineering, outdoors, and technology insights by Amer Zec"><meta property="og:type" content="blog"><meta property="og:title" content="azec.me | Blog by Amer Zec"><meta property="og:url" content="https://azec.me/"><meta property="og:site_name" content="azec.me"><meta property="og:description" content="Engineering, outdoors, and technology insights by Amer Zec"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://azec.me/img/stenciler.jpg"><meta property="article:author" content="Amer Zec"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://azec.me/img/stenciler.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://azec.me"},"headline":"azec.me | Blog by Amer Zec","image":["https://azec.me/img/stenciler.jpg"],"author":{"@type":"Person","name":"Amer Zec"},"description":"Engineering, outdoors, and technology insights by Amer Zec"}</script><link rel="alternate" href="/atom.xml" title="azec.me | Blog by Amer Zec" type="application/atom+xml"><link rel="icon" href="/img/favicon-128.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon-512.png" alt="azec.me | Blog by Amer Zec" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-25T06:22:19.000Z" title="1/24/2026, 10:22:19 PM">2026-01-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-08T01:03:20.736Z" title="2/7/2026, 5:03:20 PM">2026-02-07</time></span><span class="level-item"><a class="link-muted" href="/categories/Software/">Software</a><span> / </span><a class="link-muted" href="/categories/Software/Containers/">Containers</a></span><span class="level-item">6 minutes read (About 933 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/">Docker CLI and API version (in)compatibility with Podman Engine</a></h1><div class="content"><p>Ok, this should be a quick one, but it got me at least twice so far, so it’s time to note it down.<br>Recently I updated both Podman Desktop (<code>1.24.2</code>) as well as Podman machine (after being 16+ months old).<br>However, there was no updates to the Podman engine (currently at <code>5.7.1</code>).</p>
<p>I am using Docker CLI on macOS for all interaction with local images and containers, as Podman ensures API forwarding listening on <code>/var/run/docker.sock</code>.<br>Docker API clients (such is Docker CLI) default to this address. In most instances, you don’t need to set <code>DOCKER_HOST</code>.</p>
<p>Needless to say, just yesterday I also updated Docker CLI (<code>29.1.5</code>).</p>
<p>Until all of these updates, any Docker CLI command (such as <code>docker images</code> or <code>docker image ls</code>) was working without issues.<br>However, after the updates, I started getting this error:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">❯ docker images</span><br><span class="line"></span><br><span class="line">API version 1.41 is not supported by this client: the minimum supported API version is 1.44</span><br></pre></td></tr></table></figure>

<p>I was able to find a hint about solution, although in different context, thanks to this <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/79817033/sudden-docker-error-about-client-api-version">SO question</a>. Solution suggests that by placing <code>&#123;&quot;min-api-version&quot;: &quot;1.44&quot;&#125;</code> inside <code>~/.config/docker/daemon.json</code> or <code>~/.docker/daemon.json</code> should make this issue go away. However, I had doubts that in my scenario that would help, because I am not using Docker engine (no Docker Desktop) and I don’t think that <code>daemon.json</code> configs are acknowledged by Podman.</p>
<p>Before going further into solutions, I really wanted to understand what is going on.<br>Quick look at output of <code>docker version</code> and things started to make sense.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">❯ docker version</span><br><span class="line"></span><br><span class="line"> Client: Docker Engine - Community</span><br><span class="line"> Version:           29.1.5            &lt;----- Version of Docker CLI (also confirmed via <span class="string">&#x27;brew info docker&#x27;</span>)</span><br><span class="line"> API version:       1.52              &lt;----- API version that Docker CLI is configured <span class="keyword">for</span></span><br><span class="line"> Go version:        go1.25.6</span><br><span class="line"> Git commit:        0e6fee6c52</span><br><span class="line"> Built:             Tue Dec 16 15:33:03 2025</span><br><span class="line"> OS/Arch:           darwin/arm64</span><br><span class="line"> Context:           default</span><br><span class="line"></span><br><span class="line">Server: linux/arm64/fedora-43</span><br><span class="line"> Podman Engine:</span><br><span class="line">  Version:          5.7.1</span><br><span class="line">  APIVersion:       5.7.1</span><br><span class="line">  Arch:             arm64</span><br><span class="line">  BuildTime:        2025-12-08T16:00:00-08:00</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line">  GitCommit:        f845d14e941889ba4c071f35233d09b29d363c75</span><br><span class="line">  GoVersion:        go1.25.4 X:nodwarf5</span><br><span class="line">  KernelVersion:    6.17.7-300.fc43.aarch64</span><br><span class="line">  MinAPIVersion:    4.0.0</span><br><span class="line">  Os:               linux</span><br><span class="line"> Conmon:</span><br><span class="line">  Version:          conmon version 2.1.13, commit:</span><br><span class="line">  Package:          conmon-2.1.13-2.fc43.aarch64</span><br><span class="line"> OCI Runtime (crun):</span><br><span class="line">  Version:          crun version 1.24</span><br><span class="line">commit: 54693209039e5e04cbe3c8b1cd5fe2301219f0a1</span><br><span class="line">rundir: /run/user/501/crun</span><br><span class="line">spec: 1.0.0</span><br><span class="line">+SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +CRIU +LIBKRUN +WASM:wasmedge +YAJL</span><br><span class="line">  Package:          crun-1.24-1.fc43.aarch64</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          5.7.1              &lt;----- Version of Podman engine (also confirmed via <span class="string">&#x27;brew info podman&#x27;</span>)</span><br><span class="line">  API version:      1.41 (minimum version 1.24)  &lt;----- Version of Docker Engine API that Podman engine is working with </span><br><span class="line">  Go version:</span><br><span class="line">  Git commit:</span><br><span class="line">  Built:</span><br><span class="line">  OS/Arch:          linux/arm64</span><br><span class="line">  Experimental:</span><br></pre></td></tr></table></figure>

<p>So what are we dealing with here?</p>
<ul>
<li><p>Docker CLI <code>v29.1.5</code> (released on Jan 16, 2026) is configured with current maximum Docker Engine API version, which is <code>1.52</code></p>
</li>
<li><p>When this was released, they bumped the minimal supported Docker Engine API version to <code>1.44</code> (see <a target="_blank" rel="noopener" href="https://forums.docker.com/t/docker-29-increased-minimum-api-version-breaks-traefik-reverse-proxy/150384">this</a> for additional evidence).</p>
</li>
<li><p>Podman Engine <code>v5.7.1</code> (released on Dec 8th, 2025) is still configured for compatibility with Docker Engine API version <code>1.41</code>, but it will work with min Docker Engine API version <code>1.24</code>. I was also able to confirm this in Podman’s <a target="_blank" rel="noopener" href="https://github.com/containers/podman/blob/main/version/version.go#L43-L44">podman/version/version.go</a>. Alternative way to confirm this is with the command below:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">❯ curl --silent -XGET --unix-socket /var/run/docker.sock http://localhost/version | jq .</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="string">&quot;Platform&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;linux/arm64/fedora-43&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;Components&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;Podman Engine&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Version&quot;</span>: <span class="string">&quot;5.7.1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Details&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;APIVersion&quot;</span>: <span class="string">&quot;5.7.1&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Arch&quot;</span>: <span class="string">&quot;arm64&quot;</span>,</span><br><span class="line">          <span class="string">&quot;BuildTime&quot;</span>: <span class="string">&quot;2025-12-08T16:00:00-08:00&quot;</span>,                   &lt;---- Build time</span><br><span class="line">          <span class="string">&quot;Experimental&quot;</span>: <span class="string">&quot;false&quot;</span>,</span><br><span class="line">          <span class="string">&quot;GitCommit&quot;</span>: <span class="string">&quot;f845d14e941889ba4c071f35233d09b29d363c75&quot;</span>,</span><br><span class="line">          <span class="string">&quot;GoVersion&quot;</span>: <span class="string">&quot;go1.25.4 X:nodwarf5&quot;</span>,</span><br><span class="line">          <span class="string">&quot;KernelVersion&quot;</span>: <span class="string">&quot;6.17.7-300.fc43.aarch64&quot;</span>,</span><br><span class="line">          <span class="string">&quot;MinAPIVersion&quot;</span>: <span class="string">&quot;4.0.0&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Os&quot;</span>: <span class="string">&quot;linux&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;Conmon&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Version&quot;</span>: <span class="string">&quot;conmon version 2.1.13, commit: &quot;</span>,</span><br><span class="line">      <span class="string">&quot;Details&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;Package&quot;</span>: <span class="string">&quot;conmon-2.1.13-2.fc43.aarch64&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;OCI Runtime (crun)&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Version&quot;</span>: <span class="string">&quot;crun version 1.24\ncommit: 54693209039e5e04cbe3c8b1cd5fe2301219f0a1\nrundir: /run/user/501/crun\nspec: 1.0.0\n+SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +CRIU +LIBKRUN +WASM:wasmedge +YAJL&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Details&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;Package&quot;</span>: <span class="string">&quot;crun-1.24-1.fc43.aarch64&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;Version&quot;</span>: <span class="string">&quot;5.7.1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ApiVersion&quot;</span>: <span class="string">&quot;1.41&quot;</span>,                 &lt;----- THIS LINE</span><br><span class="line">  <span class="string">&quot;MinAPIVersion&quot;</span>: <span class="string">&quot;1.24&quot;</span>,              &lt;----- AND THIS LINE</span><br><span class="line">  <span class="string">&quot;GitCommit&quot;</span>: <span class="string">&quot;f845d14e941889ba4c071f35233d09b29d363c75&quot;</span>,</span><br><span class="line">  <span class="string">&quot;GoVersion&quot;</span>: <span class="string">&quot;go1.25.4 X:nodwarf5&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Os&quot;</span>: <span class="string">&quot;linux&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Arch&quot;</span>: <span class="string">&quot;arm64&quot;</span>,</span><br><span class="line">  <span class="string">&quot;KernelVersion&quot;</span>: <span class="string">&quot;6.17.7-300.fc43.aarch64&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BuildTime&quot;</span>: <span class="string">&quot;2025-12-08T16:00:00-08:00&quot;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>Basically, this new version of Docker CLI is capable of working with API versions [1.52, 1.44]. Podman Engine is expecting [1.41, 1.24].<br>And you can see that Podman team is already working on fixing this, in commit <a target="_blank" rel="noopener" href="https://github.com/containers/podman/commit/c9e20280ed2de26ed442a5a335e49a5dafede024">c9e2028</a>.</p>
<p>For the solution, I simply configured my <code>~/.zshrc</code> to set <code>DOCKER_API_VERSION</code> to <code>1.44</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">❯ cat ~/.zshrc | grep DOCKER</span><br><span class="line"><span class="built_in">export</span> DOCKER_API_VERSION=1.44</span><br></pre></td></tr></table></figure>

<p>The <code>DOCKER_API_VERSION</code> environment variable is used to force the Docker client to use a specific version of the API when communicating with the Docker daemon (in my case Podman Engine). By default, the Docker client and SDKs use API version negotiation to automatically select a version supported by both the client and the Docker Engine. However, setting <code>DOCKER_API_VERSION</code> disables this negotiation and locks the client to the specified version.<br>Aside from possibility to be used for feature controls, the primary use of this env var is to resolve “client and server don’t have the same version” errors, which can occur if the client is newer than the daemon. If the client is newer than the daemon, the client can request API endpoints that the daemon doesn’t know about.</p>
<p>After this, everything started working again.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">❯ docker images</span><br><span class="line">                                                                                i Info →   U  In Use</span><br><span class="line">IMAGE                         ID             DISK USAGE   CONTENT SIZE   EXTRA</span><br><span class="line">quay.io/podman/hello:latest   83fc7ce1224f        580kB             0B    U</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-24T21:42:52.000Z" title="1/24/2026, 1:42:52 PM">2026-01-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-08T01:03:20.737Z" title="2/7/2026, 5:03:20 PM">2026-02-07</time></span><span class="level-item"><a class="link-muted" href="/categories/Software/">Software</a><span> / </span><a class="link-muted" href="/categories/Software/Containers/">Containers</a></span><span class="level-item">5 minutes read (About 761 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/24/Using-Podman-with-GPU-intensive-containers/">Using Podman with GPU intensive containers</a></h1><div class="content"><p>While troubleshooting issue with Docker CLI (macOS) API version compatibility with newer versions of Podman, I have learned that the default Podman machine (a.k.a Podman engine) that I am running is over 16 months old. While updating Podman machine (actually creating new Podman machine) didn’t make the original problem go away, I learned something new through this process, which I want to document here, because it seems not too many Podman users are aware of this (yet! and it’s 2026). </p>
<p>Ok, so first I deleted “default podman machine” and I was ready to create new one in Podman Desktop UI. <strong><em>Settings &gt; Resources &gt; Create new …</em></strong></p>
<p>But then I noticed this warning:</p>
<blockquote>
<p>There is an problem finding ‘krunkit’ binary. Try to install it manualy, or install Podman from installer.</p>
</blockquote>
<p><img src="/2026/01/24/Using-Podman-with-GPU-intensive-containers/krunkit-missing.png" alt="Missing &#39;krunkit&#39;"></p>
<p>So quick googling about what this means and I learn that (starting versions 5.2.x of Podman) besides Apple Hypervisor (<code>applehv</code>), which relies on <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/virtualization">Virtualization.framework</a>, they now allow to use alternative provider (meaning, virtualization provider) for macOS. That alternative provider relies on customizations on top of <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/hypervisor">Hypervisor.framework</a>, which is lower level API (than <code>Virtualization.framework</code>) from Apple.</p>
<p>“AppleHV” (short for Apple Hypervisor) refers to the native virtualization framework built into macOS, allowing software to run virtual machines (VMs) and containers directly on Apple hardware and it is default provider (for Podman engine virtualization) on all platforms other than Apple Sillicon. Some of the things it provides are:</p>
<ul>
<li><strong>Native Virtualization:</strong> It provides a low-level, native way to manage virtualization, often using Apple’s <code>Virtualization.framework</code>.</li>
<li><strong>Podman Usage:</strong> AppleHV is commonly used as the backend provider for Podman Machine on macOS (especially with Podman v4.9.1+ and v5.x). It is often used in combination with tools like <code>vfkit</code> to create and run Linux virtual machines.</li>
<li><strong>Performance (Rosetta):</strong> On Apple Silicon (M1/M2/M3 chips), AppleHV supports <strong>Rosetta 2</strong>, allowing for near-native speed when running x86_64 containers on ARM hardware.</li>
<li><strong>Alternatives:</strong> It is the modern alternative to <strong>QEMU</strong>, which was previously the standard, often providing better performance.</li>
</ul>
<p>While Apple Hypervisor is still great on Apple Sillicon Macs for “cookie cutter” containers that mostly just need CPU, those who want to leverage GPUs on their Mac (e.g. to run LLM models through Docker/Podman) might want to take advantage of this alternative provider.</p>
<p>The alternative provider relies on two important things (also prerequisites to be able to use this provider when creating new Podman machine):</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/containers/libkrun">containers/libkrun</a> - a dynamic library that allows programs to easily acquire the ability to run processes in a partially isolated environment using <code>KVM</code> Virtualization on Linux and <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/hypervisor">HVF</a> on macOS/ARM64.</li>
<li><a target="_blank" rel="noopener" href="https://github.com/containers/krunkit">containers/krunkit</a> -  is a tool to launch configurable virtual machines using the <code>libkrun</code> platform.</li>
</ol>
<p>The latter of the two is required in order to be able to run Podman machines with this new alternative provider.<br>The installation was very simple.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap slp/krunkit</span><br><span class="line">brew install krunkit</span><br></pre></td></tr></table></figure>

<p>Restarting Podman Desktop and going to <strong><em>Settings &gt; Resources &gt; Create new…</em></strong> this time didn’t show the warning, which is signal that it properly detected <code>libkrun</code> and <code>krunkit</code>. However, first attempt to create Podman machine wiht “<em>default GPU enabled (LibKrun)</em>“ as a provider, didn’t work out as expected.<br>The machine got frozen in “<em>Currently starting up</em>“ stage forever. I had to force remove it, reboot and re-create podman machine.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Delete stuck machine</span></span><br><span class="line">podman machine rm --force podman-machine-gpu-enabled</span><br><span class="line"><span class="comment"># Reboot</span></span><br><span class="line"><span class="comment"># Create again via Podman Desktop</span></span><br><span class="line"><span class="comment"># Start</span></span><br><span class="line">podman machine start podman-machine-gpu</span><br></pre></td></tr></table></figure>

<p><img src="/2026/01/24/Using-Podman-with-GPU-intensive-containers/podman-machine-running.png" alt="New Podman machine running and using &#39;libkrun&#39;"></p>
<p>After this, I was able to see that machine is running and it is using <code>libkrun</code> for VM provider.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">podman machine list</span><br><span class="line"></span><br><span class="line">NAME                 VM TYPE     CREATED            LAST UP            CPUS        MEMORY      DISK SIZE</span><br><span class="line">podman-machine-gpu*  libkrun     About an hour ago  Currently running  4           7.451GiB    27GiB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So now, I am ready to try out some LLM models loaded via Docker/Podman. This will be exciting, because up till now, I ran most local models via <a target="_blank" rel="noopener" href="https://ollama.com/">ollama</a> and <a target="_blank" rel="noopener" href="https://lmstudio.ai/">LM Studio</a>.</p>
<h3><a href="#resources" class="header-anchor">✎</a><span id="resources">Resources</span></h3><ol>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=OyTJ8FtQaJ0">GPU Accelerated Containers on Apple Silicon with libkrun and podman machine - DevConf.US 2024</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.redhat.com/articles/2025/06/05/how-we-improved-ai-inference-macos-podman-containers#">How we improved AI inference on macOS Podman containers</a></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-11-26T20:57:56.000Z" title="11/26/2025, 12:57:56 PM">2025-11-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-01-08T06:34:20.103Z" title="1/7/2026, 10:34:20 PM">2026-01-07</time></span><span class="level-item"><a class="link-muted" href="/categories/Tools/">Tools</a><span> / </span><a class="link-muted" href="/categories/Tools/Productivity/">Productivity</a></span><span class="level-item">5 minutes read (About 715 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/">Favorite PDF tools on macOS in 2026</a></h1><div class="content"><p>It is almost the end of the 2025. I got unlucky with chalazion on both eyes after hitting a gym that I guess isn’t very well maintained and cleaned after all.<br>Ever since, I have been very sensitive with my eyes and trying not to put them through too much pressure. I also started noticing that no matter what kind of light settings I choose on the <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.obreey.reader&hl=en">PocketBook reader</a> app on the Android tablet, after a few hours of use, I start to feel the eye strain.</p>
<p>So to cope, I started searching for tools that would:</p>
<ol>
<li>Allow me to invert PDF books into black background with white text, while keeping images untouched (not inverted). This is in order to have better experience while reading on both tablet and Mac.</li>
<li>Replace not so flexible reader layouts on macOS Preview (default app for PDFs on macOS) and allow me to use more screen when reading on large monitors (27” up to 34”)</li>
<li>Ideally - they are FOSS</li>
</ol>
<p>I was not very positive at first that such tools will exist in FOSS for macOS, but I was quite wrong.<br>After some digging and crawling through some blog posts, I decided to give these two a try:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://skim-app.sourceforge.io/">Skim</a> - a PDF reader and note-taker for OS X (macOS)</li>
<li><a target="_blank" rel="noopener" href="https://www.stirling.com/">Stirling PDF</a> - actively developed open-source web-based PDF editor that cares about privacy and security</li>
</ol>
<h3><a href="#about-skim" class="header-anchor">✎</a><span id="about-skim">About Skim</span></h3><p>It is great! Very lightweight, installable through Homebrew and best of all, it has this “Horizontal Continuous” reader mode that I couldn’t be happier with. Depending on the book, it allows me to load up to 3 full pages of the book in the horizontal plane with enough zoom to not get eye strain on 27” monitor. The best part is the ease of scrolling horizontally which for me at least makes it harder to forget about the context when moving pages. For most books however, 2 pages loaded in this reading mode are the most comfortable setup. Image below shows an example.</p>
<p><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/skim-example.png" alt="Example of Skim running on macOS"></p>
<p>And the best of all is that this Horizontal Continuous reading mode can be used in full screen (image below).</p>
<p><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/skim-fullscreen.png" alt="Skim using Horizontal Continuous layout in full screen mode"></p>
<h3><a href="#about-stirling-pdf" class="header-anchor">✎</a><span id="about-stirling-pdf">About Stirling PDF</span></h3><p>Stirling helps you read and edit PDFs privately. For “home users”, or people who need to edit PDFs only every few weeks, it offers Free tier, with self-hosted web-app. It also offers binary bundles in the form of desktop application for all platforms (macOS, Linux and Windows), but those seem to be outdated and considered legacy in terms of features. It seems that development team is giving highest priority to the web-app at the moment.</p>
<p>I chose to start with <a target="_blank" rel="noopener" href="https://docs.stirlingpdf.com/#for-server-deployments">“Server Deployments”</a> option but on macOS, using Docker.<br>I simply followed <a target="_blank" rel="noopener" href="https://docs.stirlingpdf.com/Installation/Docker%20Install">“Docker Guide”</a> and I was up and running in few minutes.<br>Here is a snapshot of the main page UI.</p>
<p><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/stirling-splashpage.png" alt="Starting page of Stirling PDF"></p>
<p>Of course, the first tool that I tried to invert the color of few books was “Replace-Invert Color PDF”, and I couldn’t be happier.</p>
<p><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/stirling-invert-tool.png" alt="Replace-Invert Color PDF tool in Stirling PDF"></p>
<p>The size of those inverted PDFs isn’t small to be honest, but given that I read at most 2-3 books at any point in time, all of my devices can handle it.</p>
<p>However, even for the problem of size of PDFs, Stirling-PDF offers another great little tool in it’s toolbelt - “Compress PDF”.</p>
<p><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/stirling-compress-tool.png" alt="Compress PDF tool in Stirling PDF"></p>
<p>All in all, I think I have found a good alternative to Adobe Acrobat PRO that offers plethora of tools with safety and privacy not being neglected.</p>
<p>Until next time!</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-05-11T15:01:00.000Z" title="5/11/2021, 8:01:00 AM">2021-05-11</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-11T05:12:10.184Z" title="9/10/2024, 10:12:10 PM">2024-09-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Software/">Software</a><span> / </span><a class="link-muted" href="/categories/Software/Security/">Security</a></span><span class="level-item">23 minutes read (About 3416 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/11/Using-YubiKey-with-GitHub/">Using YubiKey with GitHub</a></h1><div class="content"><p><strong>TABLE OF CONTENTS</strong></p>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#using-yubikey-for-automatically-signing-github-commits">Using YubiKey for automatically signing GitHub commits</a></li>
<li><a href="#using-yubikey-resident-ssh-keys-and-presence-verification-for-remote-github-operations">Using YubiKey-resident SSH keys and presence verification for remote GitHub operations</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
<!-- tocstop -->

</div>
<hr>

<p>Another day, another post. And this is one I am super excited to write about.<br>As I have mentioned in the previous post, I have originally followed <a target="_blank" rel="noopener" href="https://github.com/drduh/YubiKey-Guide">drduh/YubiKey-Guide</a><br>(and numerous other guides) for general guidance on how to make YubiKey play nicely with other tools in my workflow.<br>The two aspects of configuration that are not very intuitive and more challenging are definitely the <a target="_blank" rel="noopener" href="https://github.com/drduh/YubiKey-Guide#ssh">setup of SSH</a> and <a target="_blank" rel="noopener" href="https://github.com/drduh/YubiKey-Guide#github">GitHub commits signing</a>. I primarily say this because it took me significant amount of effort to get the <code>gpg-agent</code> configured right. </p>
<p>So to make it clear, in this post I would like to focus on the following:</p>
<ol>
<li>Using YubiKey for automatically signing GitHub commits (GPG)</li>
<li>Using YubiKey-resident SSH keys and presence verification for remote GitHub operations (think <code>git push</code>)</li>
</ol>
<h3><a href="#using-yubikey-for-automatically-signing-github-commits" class="header-anchor">✎</a><span id="using-yubikey-for-automatically-signing-github-commits">Using YubiKey for automatically signing GitHub commits</span></h3><p>Before we go into any details on what needs to be configured for two to play nicely, a little intro.<br>Git is cryptographically secure, but it’s not foolproof. If you’re taking work from others on the internet and want to verify that commits are actually from a trusted source, Git has a few ways to sign and verify work using GPG.<br>First of all, if you want to sign anything you need to get GPG configured and your personal key installed. In the context of this post, you ideally want that to be done with YubiKey and your GPG keys transfered on YubiKey (at least those with <code>[S]</code> capability).</p>
<p>Before we continue, one more important thing. Signing tags and commits is great, but if you decide to use verification of commit signatures in merge strategy in a daily developer’s workflow, you’ll have to make sure that everyone on your team understands how to do so. If you don’t , you can end up spending a lot of time helping people figure out how to rewrite their commits with signed versions.</p>
<p>So what is really needed to get commits signed and view them as verified in GitHub?<br>For my case, I started by looking at my GPG keys on YubiKey.</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; gpg -K --keyid-format LONG</span><br><span class="line"></span><br><span class="line">/Users/amer/.gnupg/pubring.kbx</span><br><span class="line">------------------------------</span><br><span class="line">sec#  rsa4096/F2036890CCE43A6E 2020-12-15 [C]</span><br><span class="line">      Key fingerprint = 87DE DBA3 6B74 59EB A9DB  60D4 F203 6890 CCE4 3A6E</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amerzec@gmail.com&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@skyward.io&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@protonmail.com&gt;</span><br><span class="line">ssb&gt;  rsa4096/C7C4CE019E24528B 2020-12-15 [S] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/337469C332E23BC2 2020-12-15 [E] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/AF7288986C0C508B 2020-12-15 [A] [expires: 2031-05-04]</span><br></pre></td></tr></table></figure>
<p>The key that will be responsible for signing is subkey <code>rsa4096/C7C4CE019E24528B</code>. However, to make sure GitHub knows about it, I first had to export my public key and let GitHub know about it.<br>Exporting public key can be done with these two simple commands:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> KEYID=0xF2036890CCE43A6E</span><br><span class="line">$ gpg --armor --<span class="built_in">export</span> <span class="variable">$KEYID</span> | tee gpg-<span class="variable">$KEYID</span>-$(date +%F).asc</span><br></pre></td></tr></table></figure>
<p>which for me created ASCII file <code>gpg-0xF2036890CCE43A6E-2021-05-11.asc</code> in the working directory. Once that is done, all I had to do is upload it to GitHub. To do that go to:</p>
<p><strong><code>User Profile (icon on the top right)</code></strong> –&gt; <code>Settings</code> –&gt; <code>SSH and GPG keys</code> (menu on the left) –&gt; <code>GPG keys</code></p>
<p>and click on <strong>New GPG key</strong> (this is not the most intuitive name for actual import).<br>You will be prompted with text box where you can enter your GPG public key, as on the image below.</p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/gpg-github-import.png" alt="GitHub GPG keys / Add new"></p>
<p>Once that is confirmed, you will see that GitHub lists your GPG key in the main section, together with details about identities attached to the key, all of its subkeys and key ID. One important thing to note is that GitHub will not show your commits as verified and green, unless the e-mail address configured for signing GPG key in git config is also a verified e-mail address you are using on GitHub. Instead, in the commit log, GitHub will show yellow bubble notification that says “Unverified” - indicating that commits are signed, but that e-mail address is not trusted by GitHub as owned by the same user. To read more about this - you can follow a GitHub guide <a target="_blank" rel="noopener" href="https://docs.github.com/en/github/authenticating-to-github/using-a-verified-email-address-in-your-gpg-key">Using a verified email address in your GPG key</a>.   </p>
<p>When it comes to my GPG key and identities on it, I already had a few e-mail identities on the key that I also added and previously verified on GitHub. For others I mostly don’t care. </p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/gpg-github-details.png" alt="GitHub GPG key / verified emails"></p>
<p>Once this is done, it is time to instruct your <code>git</code> CLI on how to behave in terms of signing commits (and tags) and do some configuration.</p>
<p>First you need to tell <code>git</code> which GPG key to use for signing, if you want to sign anything.<br>Since I already had <code>$KEYID</code> holding my key, I accomplished that with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.signingkey <span class="variable">$KEYID</span></span><br></pre></td></tr></table></figure>
<p>At this point you should be able to sign commits going forward by just passing <code>-S</code> flag to the git command, e.g. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -a -S -m <span class="string">&#x27;Signed commit&#x27;</span></span><br></pre></td></tr></table></figure>
<p>However if you want to GPG sign all your commits, you have to add the <code>-S</code> option all the time.<br>The <code>commit.gpgsign</code> config option allows to sign all commits automatically. So I configured that as well</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global commit.gpgsign <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>Finally, it was time to test this. I made a simple commit. At this point, YubiKey prompts you for a smart-card PIN as on the image below.</p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/gpg-yubikey-confirm-pin-on-commit.png" alt="Git commit / YubiKey PIN confirmation"></p>
<p>Enter the pin and your commit should be good to be pushed. However if you get back response such as:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error: gpg failed to sign the data</span><br><span class="line">fatal: failed to write commit object</span><br></pre></td></tr></table></figure>
<p>it may mean that your YubiKey is not properly inserted and recognized as smart-card by <code>gpg</code>.<br>You can fix that by verifying your YubiKey is recognized:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --card-status</span><br></pre></td></tr></table></figure>
<p>If things are good, you should get large output with details about your YubiKey (which I will not share here). But if you get something like below</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg: OpenPGP card not available: Unsupported operation</span><br></pre></td></tr></table></figure>
<p>it means your YubiKey is not ready (or not properly inserted). You need to re-insert it to USB-C port as many times as needed until above command provides you with the details of your smart-card. </p>
<p>Another problem for not being able to sign commit could be that you didn’t import the key. If your YubiKey is showing ok, then you can do that with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ gpg --recv <span class="variable">$KEYID</span></span><br><span class="line">gpg: key 0xF2036890CCE43A6E: no user ID</span><br><span class="line">gpg: Total number processed: 1</span><br></pre></td></tr></table></figure>
<p>If at any point in this step (trying to make signed commit) you also get an error message saying <em>“Inappropriate ioctl for device”</em>  (like I did), I would like to point you to <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/41052538/git-error-gpg-failed-to-sign-data/41054093">this StackOverflow thread</a> as a great resource that helped me out. Basically to resolve it, in my <code>~/.zshrc</code> file I had to add:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GPG_TTY=$(tty)</span><br></pre></td></tr></table></figure>
<p>What this does is it makes the name of the terminal attached to standard input available to <code>gpg</code> program in your active shell. For me that is <code>zsh</code>.</p>
<p>At this point, everything was ok. After retrying commit and entering PIN once again, it went fine. And finally, after visiting commit log in GitHub, I could confirm that my commits are now signed and with GPG identity that matches one of my verified GitHub e-mail addresses.</p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/github-signed-commit-verified.png" alt="Git commit log / Verified commit"></p>
<p>So far so good. Now, it is the time to talk about SSH keys used for GitHub.</p>
<h3><a href="#using-yubikey-resident-ssh-keys-and-presence-verification-for-remote-github-operations" class="header-anchor">✎</a><span id="using-yubikey-resident-ssh-keys-and-presence-verification-for-remote-github-operations">Using YubiKey-resident SSH keys and presence verification for remote GitHub operations</span></h3><p>The goal of this section is to share my 1-day fresh experience of using new SSH keys for GitHub managed by YubiKey. While it has long been possible to <a target="_blank" rel="noopener" href="https://developers.yubico.com/PIV/Guides/Securing_SSH_with_OpenPGP_or_PIV.html">use the YubiKey for SSH</a> via the OpenPGP or PIV feature, the direct support in SSH is easier to set up, more portable, and works with any U2F or FIDO2 security key – even older ones like the <a target="_blank" rel="noopener" href="https://support.yubico.com/hc/en-us/articles/360013656800-FIDO-U2F-Security-Key">FIDO U2F Security Key</a> by Yubico.</p>
<p>Well, before I drill into the details about how to configure resident SSH keys with passwordless MFA and use them for GitHub remote operations (think <code>git push</code>), I would just like to mention that my excitement is huge because this is a new feature announced by GitHub and YubiKey on May 10th 2021 (see <a href="#resources">resources</a> at the bottom of the post for these exciting posts).</p>
<p>In SSH, two algorithms are used: a key exchange algorithm (Diffie-Hellman or the elliptic-curve variant called ECDH) and a signature algorithm. The key exchange yields the secret key which will be used to encrypt data for that session. The signature is so that the client can make sure that it talks to the right server (another signature, computed by the client, may be used if the server enforces key-based client authentication). Even when ECDH is used for the key exchange, most SSH servers and clients will use DSA or RSA keys for the signatures. If you want a signature algorithm based on elliptic curves, then that’s <code>ECDSA</code> or <code>Ed25519</code>. *<em>And those are the types of SSH keys that GitHub just added support. *</em> So going forward, for my case, I will focus on generating <code>Ed25519</code> based SSH keys using YubiKey.</p>
<p>So let’s dive in. Before we can do anything here, it is important to have <code>openssh</code> and <a target="_blank" rel="noopener" href="https://github.com/Yubico/libfido2">libfido2</a> installed. On Mac, both can be installed with <code>brew</code>. For other UNIX-oid OS-es the <code>libfido2</code> GitHub page provides installation instructions. It is also important for <code>openssh</code> to be at <strong>v8.2</strong> or later.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ brew install openssh libfido2</span><br><span class="line">Warning: openssh 8.6p1 is already installed and up-to-date.</span><br><span class="line">To reinstall 8.6p1, run:</span><br><span class="line">  brew reinstall openssh</span><br><span class="line">Warning: libfido2 1.7.0 is already installed and up-to-date.</span><br><span class="line">To reinstall 1.7.0, run:</span><br><span class="line">  brew reinstall libfido2</span><br></pre></td></tr></table></figure>
<p>Since I have already done this, I just get the warnings for both, showing current versions (which I am happy with).</p>
<p>Another prerequisite for this is to ensure that FIDO/U2F interface is enabled on YubiKey. This can be done with using <a target="_blank" rel="noopener" href="https://formulae.brew.sh/formula/ykman">ykman</a> (another tool available via <code>brew</code> for YubiKey configuration).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ ykman info</span><br><span class="line">Device <span class="built_in">type</span>: YubiKey 5Ci</span><br><span class="line">Serial number: &lt;REDACTED&gt;</span><br><span class="line">Firmware version: 5.2.7</span><br><span class="line">Form factor: Keychain (USB-C, Lightning)</span><br><span class="line">Enabled USB interfaces: OTP, FIDO, CCID</span><br><span class="line"></span><br><span class="line">Applications</span><br><span class="line">FIDO2   	Enabled</span><br><span class="line">OTP     	Enabled</span><br><span class="line">FIDO U2F	Enabled</span><br><span class="line">OATH    	Enabled</span><br><span class="line">OpenPGP 	Enabled</span><br><span class="line">PIV     	Enabled</span><br></pre></td></tr></table></figure>

<p>The first thing we have to do is to generate SSH keypair.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -vvv -t ed25519-sk -O resident -O verify-required -C azec.pdx@pm.me</span><br><span class="line">Generating public/private ed25519-sk key pair.</span><br><span class="line">You may need to touch your authenticator to authorize key generation.</span><br><span class="line">Enter PIN <span class="keyword">for</span> authenticator:</span><br><span class="line">debug3: start_helper: started pid=2878</span><br><span class="line">debug3: ssh_msg_send: <span class="built_in">type</span> 5</span><br><span class="line">debug3: ssh_msg_recv entering</span><br><span class="line">debug1: start_helper: starting /usr/<span class="built_in">local</span>/Cellar/openssh/8.6p1/libexec/ssh-sk-helper</span><br><span class="line">debug1: sshsk_enroll: provider <span class="string">&quot;internal&quot;</span>, device <span class="string">&quot;(null)&quot;</span>, application <span class="string">&quot;ssh:&quot;</span>, userid <span class="string">&quot;(null)&quot;</span>, flags 0x25, challenge len 0 with-pin</span><br><span class="line">debug1: sshsk_enroll: using random challenge</span><br><span class="line">debug1: sk_probe: 1 device(s) detected</span><br><span class="line">debug1: sk_probe: selecting sk by touch</span><br><span class="line">debug1: ssh_sk_enroll: using device IOService:/AppleACPIPlatformExpert/PCI0@0/AppleACPIPCI/XHC1@14/XHC1@14000000/HS03@14300000/YubiKey OTP+FIDO+CCID@14300000/IOUSBHostInterface@1/AppleUserUSBHostHIDDevice</span><br><span class="line">debug1: ssh_sk_enroll: fido_dev_make_cred: FIDO_ERR_PIN_NOT_SET</span><br><span class="line">debug1: sshsk_enroll: provider <span class="string">&quot;internal&quot;</span> failure -1</span><br><span class="line">debug1: ssh-sk-helper: Enrollment failed: invalid format</span><br><span class="line">debug1: main: reply len 8</span><br><span class="line">debug3: ssh_msg_send: <span class="built_in">type</span> 5</span><br><span class="line">debug1: client_converse: helper returned error -4</span><br><span class="line">debug3: reap_helper: pid=2878</span><br><span class="line">Key enrollment failed: invalid format</span><br></pre></td></tr></table></figure>
<p><strong>NOTE 1:</strong> <em><code>-O resident</code> option ensures generated SSH key is resident to security key (YubiKey) - it is easier to import it to a new computer because it can be loaded directly from the security key.</em><br><strong>NOTE 2:</strong> <em><code>-O verify-required</code> option ensures that security key will be configured to require a PIN or other user authentication whenever you use this SSH key.</em></p>
<p>As you can see, this failed for me first time. Thanks to the verbose logging, I was able to see that the problem with this is that I have never actually tinkered with FIDO2 feature of YubiKey and therefore I left the FIDO2 PIN unset. So I had to change that. And the simplest way to do this is to re-insert YubiKey and pull out <a target="_blank" rel="noopener" href="https://www.yubico.com/support/download/yubikey-manager/">YubiKey Manager app</a>, then go to <code>Applications</code> –&gt; <code>FIDO2</code> and finally <code>Set PIN</code>, as indicated on the image below.</p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/yubikey-manager-setting-fido2-pin.png" alt="YubiKey Manager / Setting FIDO2 PIN"></p>
<p>After that was done, my second attempt was successful:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t ed25519-sk -O resident -O verify-required -C azec.pdx@pm.me</span><br><span class="line">Generating public/private ed25519-sk key pair.</span><br><span class="line">You may need to touch your authenticator to authorize key generation.</span><br><span class="line">Enter PIN <span class="keyword">for</span> authenticator:                                                            &lt;-- !!! ENTER FIDO2 PIN HERE</span><br><span class="line">debug3: start_helper: started pid=18785</span><br><span class="line">debug1: start_helper: starting /usr/<span class="built_in">local</span>/Cellar/openssh/8.6p1/libexec/ssh-sk-helper</span><br><span class="line">debug3: ssh_msg_send: <span class="built_in">type</span> 5</span><br><span class="line">debug3: ssh_msg_recv entering</span><br><span class="line">debug1: sshsk_enroll: provider <span class="string">&quot;internal&quot;</span>, device <span class="string">&quot;(null)&quot;</span>, application <span class="string">&quot;ssh:&quot;</span>, userid <span class="string">&quot;(null)&quot;</span>, flags 0x25, challenge len 0 with-pin</span><br><span class="line">debug1: sshsk_enroll: using random challenge</span><br><span class="line">debug1: sk_probe: 1 device(s) detected</span><br><span class="line">debug1: sk_probe: selecting sk by touch</span><br><span class="line">debug1: ssh_sk_enroll: using device IOService:/AppleACPIPlatformExpert/PCI0@0/AppleACPIPCI/XHC1@14/XHC1@14000000/HS03@14300000/YubiKey OTP+FIDO+CCID@14300000/IOUSBHostInterface@1/AppleUserUSBHostHIDDevice</span><br><span class="line">debug1: ssh_sk_enroll: attestation cert len=706</span><br><span class="line">debug1: ssh_sk_enroll: authdata len=129</span><br><span class="line">debug1: main: reply len 1058</span><br><span class="line">debug3: ssh_msg_send: <span class="built_in">type</span> 5</span><br><span class="line">debug3: reap_helper: pid=18785</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/Users/amer/.ssh/id_ed25519_sk): azec-pdx-github</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> azec-pdx-github</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> azec-pdx-github.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:J20G1tWmQAro4fkYDQ7WMPu15QLuww5gu4Y3dABdCmg azec.pdx@pm.me</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+[ED25519-SK 256]-+</span></span><br><span class="line"><span class="string">|o.o+...  .. ..   |</span></span><br><span class="line"><span class="string">|oE++=  . o..  o  |</span></span><br><span class="line"><span class="string">|.oo=.=. = .. o   |</span></span><br><span class="line"><span class="string">|  .o*o.= o  .    |</span></span><br><span class="line"><span class="string">|.. .o+o S =      |</span></span><br><span class="line"><span class="string">|..ooo .. =       |</span></span><br><span class="line"><span class="string">|.o..+            |</span></span><br><span class="line"><span class="string">|..+o .           |</span></span><br><span class="line"><span class="string">|.o ..            |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure>
<p><strong>NOTE:</strong> The line <code>Enter PIN for authenticator:</code> is asking for your FIDO2 pin (set in previous step). After you enter it correctly, the prompt will hang on the next line and not do anyhing until you tap on the YubiKey sensor. This is in order to verify user’s presence while generating the key as well as to provide some entropy for the key generation. It doesn’t say so anywhere in the guides, and I barely noticed blinking green led light on the device as it was too close to another one of my USB cables.</p>
<p>Note that the above sequence for generating SSH key will actually persist public and private keys to your <code>~/.ssh</code> directory under name you specify.</p>
<p>In order to be able to use this SSH key with GitHub, we need to import it to GitHub by going to <code>User Profile</code> (upper right corner) –&gt; <code>Settings</code> –&gt; <code>SSH and GPG keys</code> –&gt; <code>New SSH key</code>, or simply clicking on <a target="_blank" rel="noopener" href="https://github.com/settings/keys">keys</a> if you are already logged in to GitHub.<br>Then copy your key to clipboard </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbcopy &lt; ~/.ssh/azec-pdx-github.pub</span><br></pre></td></tr></table></figure>
<p>and stash it to the <strong>Key</strong> field below.</p>
<p><img src="/2021/05/11/Using-YubiKey-with-GitHub/github-ssh-key-adding.png" alt="GitHub SSH Keys / Adding public key"></p>
<p>Make sure you give it a nice title if you are managing multiple keys. GitHub may ask you to re-enter your password at this step, despite being logged in. Once that is done, we can verify that key is listed under new name on <a href="[keys](https://github.com/settings/keys)">SSH and GPG keys</a> page.</p>
<p>Now that we have added keys to the GitHub, it is time to do some local ssh configuration.<br>One of the nuances is that with <code>openssh</code> being required, it doesn’t play very well with Mac keychain for remembering SSH key passphrases. So if you had previous config under <code>~/.ssh/config</code> , you may need to change a thing or two. In my case I had to add this line to the top of config:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Host *</span><br><span class="line">        IgnoreUnknown UseKeychain</span><br></pre></td></tr></table></figure>

<p>Additionally for my <code>github.com</code> host configuration, I had to comment line about <code>UseKeychain</code>, like shown below.</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">        HostName github.com</span><br><span class="line">  	User git</span><br><span class="line">	AddKeysToAgent yes</span><br><span class="line">  	# UseKeychain yes</span><br><span class="line">  	IdentityFile /Users/amer/.ssh/azec-pdx-github</span><br></pre></td></tr></table></figure>

<p>Once that is done, it was time to test YubiKey behavior and use of new SSH key with <code>git push</code>.<br>Out of curiosity, I unplugged YubiKey to see what will the failure look like. And here it is.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;my_git_repo&gt; $ git push</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/Users/amer/.ssh/azec-pdx-github&#x27;</span>:</span><br><span class="line">Enter PIN <span class="keyword">for</span> ED25519-SK key /Users/amer/.ssh/azec-pdx-github:</span><br><span class="line">Confirm user presence <span class="keyword">for</span> key ED25519-SK SHA256:J20G1tWmQAro4fkYDQ7WMPu15QLuww5gu4Y3dABdCmg</span><br><span class="line">sign_and_send_pubkey: signing failed <span class="keyword">for</span> ED25519-SK <span class="string">&quot;/Users/amer/.ssh/azec-pdx-github&quot;</span>: invalid format</span><br><span class="line">git@github.com: Permission denied (publickey).</span><br><span class="line">fatal: Could not <span class="built_in">read</span> from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure>
<p>While the error <strong><em>sign_and_send_pubkey: signing failed for ED25519-SK “/Users/amer/.ssh/azec-pdx-github”: invalid format</em></strong> is indicative that things didn’t go well, it is also little misleading. The real problem here is that despite entering correct SSH key passphrase and entering correct FIDO2 PIN, there is no security key present on the USB interface. Since the user presence verification (by doing “tap” on security key as we will see later in successful attempt) comes after passphrase and PIN entry steps, the whole step of SSH signing fails, which <code>git</code> finally presents us with: </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git@github.com: Permission denied (publickey).</span><br><span class="line">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>

<p>Now, finally the last step. It was time to try the actual push with security key present. So I inserted my YubiKey and verified that FIDO2 interface is visible to the system with below command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ FIDO_DEBUG=1 fido2-token -L</span><br><span class="line">IOService:/AppleACPIPlatformExpert/PCI0@0/AppleACPIPCI/XHC1@14/XHC1@14000000/HS03@14300000/YubiKey OTP+FIDO+CCID@14300000/IOUSBHostInterface@1/AppleUserUSBHostHIDDevice: vendor=0x1050, product=0x0407 (Yubico YubiKey OTP+FIDO+CCID)</span><br></pre></td></tr></table></figure>

<p>Then I tried <code>git push</code> once again with outcome in the next snippet.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/Users/amer/.ssh/azec-pdx-github&#x27;</span>:</span><br><span class="line">Enter PIN <span class="keyword">for</span> ED25519-SK key /Users/amer/.ssh/azec-pdx-github:</span><br><span class="line">Confirm user presence <span class="keyword">for</span> key ED25519-SK SHA256:J20G1tWmQAro4fkYDQ7WMPu15QLuww5gu4Y3dABdCmg</span><br><span class="line">User presence confirmed</span><br><span class="line">Enumerating objects: 5, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 16 threads</span><br><span class="line">Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 999 bytes | 999.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">To github.com:&lt;REDACTED&gt;/&lt;REDACTED&gt;.git</span><br><span class="line">   8e59217..d75ce8d  feature/&lt;REDACTED&gt; -&gt; feature/&lt;REDACTED&gt;</span><br></pre></td></tr></table></figure>

<p>Voila! All good! After entering SSH key passphrase, FIDO2 PIN and finally confirming my presence by doing “tap” on the security key, the push was success! My commit was now on the git remote.</p>
<h3><a href="#resources" class="header-anchor">✎</a><span id="resources">Resources</span></h3><p>While trying to get this all right, following resources were a great help to me:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.blog/2021-05-10-security-keys-supported-ssh-git-operations/#towards-a-future-with-fewer-passwords">05-10-2021 - GitHub Blog Post - Security keys are now supported for SSH Git operations</a></li>
<li><a target="_blank" rel="noopener" href="https://www.yubico.com/blog/github-now-supports-ssh-security-keys/">05-10-2021 - Yubico Blog Post - GitHub now supports SSH security keys</a></li>
<li><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/50878/ecdsa-vs-ecdh-vs-ed25519-vs-curve25519">ECDSA vs ECDH vs Ed25519 vs Curve25519 - Security StackExchange Discussion</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/41052538/git-error-gpg-failed-to-sign-data/41054093">Git error - gpg failed to sign data - StackOverflow Discussion</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Yubico/libfido2/issues/125">Yubico/libfido2 GitHub Issue 125 - Key enrollment failed: invalid format</a></li>
</ol>
<p>Until the next post, keep it safe!</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-05-11T01:30:40.000Z" title="5/10/2021, 6:30:40 PM">2021-05-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-11T05:12:10.183Z" title="9/10/2024, 10:12:10 PM">2024-09-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Software/">Software</a><span> / </span><a class="link-muted" href="/categories/Software/Security/">Security</a></span><span class="level-item">17 minutes read (About 2577 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/">PGP with YubiKey &amp; Keybase &amp; Protonmail</a></h1><div class="content"><p><strong>TABLE OF CONTENTS</strong></p>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#intro-to-yubikey-and-generating-gpg-keys">Intro to YubiKey and generating GPG keys</a></li>
<li><a href="#using-gpg-keys-managed-by-yubikey-with-keybase">Using GPG keys (managed by YubiKey) with Keybase</a></li>
<li><a href="#using-gpg-keys-managed-by-yubikey-with-protonmail">Using GPG keys (managed by YubiKey) with ProtonMail</a></li>
</ul>
<!-- tocstop -->

</div>
<hr>

<h3><a href="#intro-to-yubikey-and-generating-gpg-keys" class="header-anchor">✎</a><span id="intro-to-yubikey-and-generating-gpg-keys">Intro to YubiKey and generating GPG keys</span></h3><p>It has been a good few months since I started playing with and using <a target="_blank" rel="noopener" href="https://www.yubico.com/product/yubikey-5ci/">YubiKey 5ci</a>.<br>So far I haven’t really used it for anything more serious, at least not until I learn enough about its capabilities, as well as how to use it together with <code>gpg</code> suite.</p>
<p>YubiKey 5Ci truly is the first of its kind.<br>Of all the features you can read about on the product page I would just mention these:</p>
<ul>
<li><strong>Function:</strong> WebAuthn, FIDO2 CTAP1, FIDO2 CTAP2, Universal 2nd Factor (U2F), Smart card (PIV-compatible), Yubico OTP, OATH – HOTP (Event), OATH – TOTP (Time), Open PGP, Secure Static Password</li>
<li><strong>Cryptographic Specifications:</strong> RSA 2048, RSA 4096 (PGP), ECC p256, ECC p384</li>
<li><strong>Certifications:</strong> FIDO 2 Certified, FIDO Universal 2nd Factor (U2F) Certified</li>
<li><strong>Device Type:</strong> FIDO HID Device, CCID Smart Card, HID Keyboard</li>
</ul>
<p>It is also worth mentioning that it has good support from password managers.<br>Basically, you can use it as 2nd factor authentication device in two ways:</p>
<ol>
<li><p>By using it <strong>as virtual MFA device</strong>. For this to work you need the device plugged into one of your mobile/desktop (physical) devices and <a target="_blank" rel="noopener" href="https://www.yubico.com/products/yubico-authenticator/">Yubico Authenticator</a> app/client for one of the supported OSes.</p>
</li>
<li><p>By using it as <strong>FIDO U2F device</strong>. For those that are new to this, here is what it means:</p>
<blockquote>
<p>U2F is an open authentication standard that enables internet users to securely access any number of online services with one single security key instantly and with no drivers or client software needed.</p>
</blockquote>
<p>You can read more about this feature <a target="_blank" rel="noopener" href="https://www.yubico.com/authentication-standards/fido-u2f/">on the product page</a>.<br>Basically the device comes equipped with two pins (one on each side) that you need to press when prompted for 2nd factor key from services that support this standard. On the press of those keys, device generates series of keystrokes that are verified by service provider, in similar fashion how OTP tokens are generated in the 1st option above.</p>
</li>
</ol>
<p>It may have caught your attention but if it did not - this device also can behave as a Smart Card and offers Open PGP functionality. What this means is that you can use it to manage your GPG keys in multiple ways. And that is exactly what I want to focus on in this post, with emphasis on my use-cases:</p>
<ol>
<li>Using GPG keys managed by YubiKey with Keybase</li>
<li>Using GPG keys managed by YubiKey with ProtonMail</li>
<li><em>IDEALLY</em> - Using just single GPG key managed by YubiKey for both Keybase and ProtonMail</li>
</ol>
<p>First and probably most important thing to know (which you could guess, I didn’t know when I started experimenting) is that with posession of security key (YubiKey), users have two strategies how to manage GPG keys:</p>
<ol>
<li>Generating Keys externally from the YubiKey</li>
<li>Generating Your PGP Key directly on Your YubiKey</li>
</ol>
<p>Both of the above methods have pros and cons:</p>
<p><strong>Pros:</strong></p>
<ul>
<li>1st method provides opportunity to backup GPG keys elsewhere</li>
<li>2nd method (generating the PGP on the YubiKey) ensures that malware can never steal your PGP private key</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>1st method - it is strongly recommended that you to generate keys on an offline system</li>
<li>2nd method - it means that the key can not be backed up so if your YubiKey is lost or damaged the PGP key is irrecoverable</li>
</ul>
<p>However, of the two methods above, the first one is strongly recommended (by YubiKey) because 1st method provides opportunity of “safely” backup GPG keys (in sume durable form - either paper or other electronic form), at least according to the official article <em><a target="_blank" rel="noopener" href="https://support.yubico.com/hc/en-us/articles/360013790259-Using-Your-YubiKey-with-OpenPGP">Using Your YubiKey with OpenPGP</a></em>. You can find more details about proceedure for generating GPG keys for both strategies on that page.</p>
<p>As far as my keys are concerned, I have followed another (by now very famous guide) at <a target="_blank" rel="noopener" href="https://github.com/drduh/YubiKey-Guide">drduh/YubiKey-Guide</a>.</p>
<p>The process is pretty straightforward and eventually I ended up with 1 master key and 3 subkeys (one for signing, one for encryption and one for authentication):</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; gpg -K --keyid-format LONG</span><br><span class="line"></span><br><span class="line">/Users/amer/.gnupg/pubring.kbx</span><br><span class="line">------------------------------</span><br><span class="line">sec#  rsa4096/F2036890CCE43A6E 2020-12-15 [C]</span><br><span class="line">      Key fingerprint = 87DE DBA3 6B74 59EB A9DB  60D4 F203 6890 CCE4 3A6E</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amerzec@gmail.com&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@skyward.io&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@protonmail.com&gt;</span><br><span class="line">ssb&gt;  rsa4096/C7C4CE019E24528B 2020-12-15 [S] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/337469C332E23BC2 2020-12-15 [E] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/AF7288986C0C508B 2020-12-15 [A] [expires: 2031-05-04]</span><br></pre></td></tr></table></figure>

<p>Next, I wanted to explore how can I use this key with Keybase.</p>
<h3><a href="#using-gpg-keys-managed-by-yubikey-with-keybase" class="header-anchor">✎</a><span id="using-gpg-keys-managed-by-yubikey-with-keybase">Using GPG keys (managed by YubiKey) with Keybase</span></h3><p>Keybase comes with variety of options for PGP in its CLI subcommand <code>keybase pgp [OPTIONS]</code>. The ones most relevant for our topic here are:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select	Select a key from GnuPG as your own and register the public half with Keybase</span><br><span class="line">import	Import a PGP key into keybase</span><br><span class="line">drop		Drop Keybase&#x27;s use of a PGP key</span><br><span class="line">list		List the active PGP keys in your account.</span><br></pre></td></tr></table></figure>

<p>If you had any previously generated (and/or managed by Keybase) GPG keys, I recommend that you use <code>drop</code> option to drop them. This was certainly my case, as I was only interested in adding to the Keybase my public GPG key, specifically the one managed by YubiKey, so that other users on this network can use it to encrypt messages to me via <a target="_blank" rel="noopener" href="https://keybase.io/azec#_">Keybase Chat</a>. </p>
<p>Now to the hard part. There are two very similar but somewhat confusing ways to add your GPG key to Keybase. Using <code>select</code> or using <code>import</code> subcommand listed above. In this step, it really depends what you want to do.<br>As I said earlier, my interest WAS NOT to have Keybase keyring managing any secret/private part of my GPG keys. So I had to read carefully what each of these subcommands does. And for posterity, here is the the gist of each:</p>
<ul>
<li><p>The <code>import</code> subcommand</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line">keybase pgp import [command options]</span><br><span class="line"></span><br><span class="line">DESCRIPTION:</span><br><span class="line">&quot;keybase pgp import&quot; imports a PGP secret key for use with Keybase.</span><br><span class="line">It accepts that secret key via file (with the &quot;--infile&quot; flag) or</span><br><span class="line">otherwise via standard input. The secret key is used to sign the</span><br><span class="line">public PGP key into the user&#x27;s Keybase sigchain. The secret key</span><br><span class="line">is also imported into the local Keybase keyring and encrypted with</span><br><span class="line">the local key security protocol.</span><br><span class="line"></span><br><span class="line">If (and only if) the &quot;--push-secret&quot; flag is specified, this command</span><br><span class="line">pushes the PGP secret key to the Keybase server, encrypted with the</span><br><span class="line">user&#x27;s passphrase. The server, in this case, could theoretically</span><br><span class="line">recover the PGP secret key by cracking the user&#x27;s passphrase.</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">-i, --infile 	Specify an infile (stdin by default).</span><br><span class="line">--push-secret	Push an encrypted copy of the secret key to the server.</span><br></pre></td></tr></table></figure>
<p>  As I have already stated twice, my case was not to import secret key to local Keybase keyring and neither was it to push secret key to Keybase server.<br>  So I completely skipped this subcommand.</p>
</li>
<li><p>The <code>select</code> subcommand</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line">keybase pgp select [command options] [key query]</span><br><span class="line"></span><br><span class="line">DESCRIPTION:</span><br><span class="line">&quot;keybase pgp select&quot; looks at the local GnuPG keychain for all</span><br><span class="line">available secret keys. It then makes those keys available for use with keybase.</span><br><span class="line">The steps involved are: (1a) sign a signature chain link with the selected PGP</span><br><span class="line">key and the existing device key; (1b) push this signature and the public PGP</span><br><span class="line">key to the server; and if &quot;--import&quot; flag is passed: (2a) copy the PGP secret half</span><br><span class="line">into your local Keybase keyring; and (2b) encrypt this secret key with Keybase&#x27;s</span><br><span class="line">local key security mechanism.</span><br><span class="line"></span><br><span class="line">By default, Keybase suggests only one PGP public key, but if you want to,</span><br><span class="line">you can supply the &quot;--multi&quot; flag to override this restriction. If you</span><br><span class="line">want your secret key imported into the local Keybase keyring, then use</span><br><span class="line">the &quot;--import&quot; flag. Importing your secret key to Keybase keyring makes</span><br><span class="line">it possible to use Keybase PGP commands like &quot;pgp decrypt&quot; or &quot;pgp sign&quot;.</span><br><span class="line"></span><br><span class="line">If you don&#x27;t want to publish signature chain link to Keybase servers, use</span><br><span class="line">&quot;--no-publish&quot; flag. It&#x27;s only valid when both &quot;--no-publish&quot; and &quot;--import&quot;</span><br><span class="line">flags are used.</span><br><span class="line"></span><br><span class="line">This operation will never push your secret key, encrypted or otherwise,</span><br><span class="line">to the Keybase server.</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">--multi	Allow multiple PGP keys.</span><br><span class="line">--import	Import private key to the local Keybase keyring.</span><br><span class="line">--no-publish	Only import to Keybase keyring, do not publish on user profile.</span><br></pre></td></tr></table></figure>

<p>  As described, this command provides a way of selecting multiple GPG keys from local GPG keyring and then making them available for use with Keybase. So basically, this is all I needed (minus all the fancy stuff).</p>
</li>
</ul>
<p>So to finalize this section, I have done following to make my public GPG key available to Keybase:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; keybase pgp select --multi</span><br><span class="line"></span><br><span class="line">You are selecting a PGP key from your local GnuPG keychain, and</span><br><span class="line">will publish a statement signed with this key to make it part of</span><br><span class="line">your Keybase.io identity.</span><br><span class="line"></span><br><span class="line">Note that GnuPG will prompt you to perform this signature.</span><br><span class="line"></span><br><span class="line">You can also import the secret key to *local*, *encrypted* Keybase</span><br><span class="line">keyring, enabling decryption and signing with the Keybase client.</span><br><span class="line">To do that, use &quot;--import&quot; flag.</span><br><span class="line"></span><br><span class="line">Learn more: keybase pgp help select</span><br><span class="line"></span><br><span class="line">#    Algo    Key Id             Created   UserId</span><br><span class="line">=    ====    ======             =======   ======</span><br><span class="line">1    4096R   F2036890CCE43A6E             Amer Zec &lt;amer.zec@pm.me&gt;, Amer Zec &lt;azec.pdx@pm.me&gt;, Amer Zec &lt;amerzec@gmail.com&gt;, Amer Zec &lt;amer.zec@skyward.io&gt;, Amer Zec &lt;azec.pdx@protonmail.com&gt;</span><br><span class="line">Choose a key:</span><br></pre></td></tr></table></figure>

<p>After selecting the only option available (<code>1</code>) my key showed up as verified and published on Keybase <a target="_blank" rel="noopener" href="https://keybase.io/azec/pgp_keys.asc?fingerprint=87dedba36b7459eba9db60d4f2036890cce43a6e">0xF2036890CCE43A6E</a>. Notice that I did not pass <code>--import</code> flag to the above command, as I am not interested in the Keybase CLI features such as <code>keybase pgp decrypt</code> and <code>keybase pgp sign</code>. </p>
<p>Next, I wanted to explore how can I use this same GPG key with ProtonMail.</p>
<h3><a href="#using-gpg-keys-managed-by-yubikey-with-protonmail" class="header-anchor">✎</a><span id="using-gpg-keys-managed-by-yubikey-with-protonmail">Using GPG keys (managed by YubiKey) with ProtonMail</span></h3><p>Now, in the interest of saving you time - I will state it upfront, this is actually not possible. If you are interested in knowing more about why, read on.</p>
<p>So one thing about ProtonMail is that their UI provides users with opportunity to generate new PGP keys. This is all well described in their <a target="_blank" rel="noopener" href="https://protonmail.com/support/knowledge-base/how-to-use-pgp/">How to use PGP</a> article.<br>And for quite some time, I have had separate keys that vere completely managed by ProtonMail. By managed, I mean, that keys were generated on ProtonMail and never ever exported elsewhere to any external system. While ProtonMail allows exporting both public and private GPG keys generated by their UI, I never had interest in doing so. </p>
<p>Also, I didn’t have a need to generate ProtonMail GPG keys externally and import them (another ProtonMail feature), until now. I was on the happy path following these steps:</p>
<ol>
<li>I have analyzed keys (by importing them to local GPG keyring) that were managed by ProtonMail to see what capabilities they have. I noted that they generate 1 subkey which has both <code>[SC]</code> capabilities. I also noted that this is not the case with any of my subkeys generated with YubiKey and started wondering if this will be causing any issues when I try to import YubiKey-managed keys.</li>
<li>I completely deleted my GPG keys managed by ProtonMail from their UI attached to one of my e-mail identities of interest. I also deleted them from the local GPG keyring.</li>
<li>(please do this with caution), I have obtained my YubiKeys backup, and tried to import subkeys private key + public key to ProtonMail. Everything was smooth until it prompted me for private key passphrase. However with 100% certainty that I am entering correct passphrase, it kept re-prompting me endlessly to enter it again. At this point I knew there is something wrong and decided to stop here.</li>
</ol>
<p>After being blocked on step 3. I have decided to reach out to ProtonMail support and describe my case. Here is the gist of my ask and their follow-up.</p>
<p><em>me:</em> </p>
<pre><code>Timestamp: 1620182869

Hi there,

I am trying to consolidate my GPG subkeys managed with YubiKey and my GPG keys imported in ProtonMail. Originally I was generating private/public key from within ProtonMail - one for each of my ProtonMail identities and when I export them and import them to my GPG ring they show following:

pub rsa4096 2019-03-14 [SC]
766B78E832154AD500656D3B289A688B26C7CA3A
uid [ unknown] amer.zec@pm.me &lt;amer.zec@pm.me&gt;
sub rsa4096 2019-03-14 [E]

pub rsa4096 2021-04-25 [SC]
9C2BEC2FB2A1289237BCDA0349AA76F7ECE2D91A
uid [ unknown] azec.pdx@pm.me &lt;azec.pdx@pm.me&gt;
sub rsa4096 2021-04-25 [E]

However, since I started using YubiKey I have this setup:
1 master key with C capability
1 subkey with S capability
1 subkey with E capability
1 subkey with A capability

and all my ProtonMail and other e-mail identities are added to the master key.

So I am curious if there is a way for me to discard above keys that originated by ProtonMail and import some combination of subkeys that I manage with YubiKey? If so, would the capabilities of my existing keys be sufficient, or I would have to create additional subkeys just for ProtonMail use?

Thanks!</code></pre><p><em>ProtonMail support:</em></p>
<pre><code>Hello,

Thank you for contacting ProtonMail support.

Unfortunately, importing subkeys without the master key is not supported. In the GPG documentation, you can see that &quot;this is a GNU extension to OpenPGP and other implementations cannot be expected to successfully import such a key.&quot;
https://www.gnupg.org/documentation/manpage.html

Our documentation on using PGP can be found in this article:
https://protonmail.com/support/knowledge-base/how-to-use-pgp/

Feel free to get back to us with any additional questions or concerns. Our team remains available if needed. 
Kind regards,
Ivana

Customer Support
ProtonMail</code></pre><p>So while the quick follow up kicked in with joy once I saw the e-mail, it was pretty disappointing to learn that ProtonMail doesn’t support importing subkeys. And for me, importing my master secret key (after moving it to YubiKey secure card) was not an option. </p>
<p>As an alternative, I have decided to use separate ProtonMail managed pair of GPG keys, as listed below (links lead to public key hosted on my website):</p>
<ul>
<li>Main GPG (YubiKey managed) &amp; Keybase key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0xF2036890CCE43A6E.asc">0xF2036890CCE43A6E</a> (identities on key: <a href="mailto:amer.zec@pm.me">amer.zec@pm.me</a>, <a href="mailto:azec.pdx@pm.me">azec.pdx@pm.me</a>, <a href="mailto:amerzec@gmail.com">amerzec@gmail.com</a>, <a href="mailto:amer.zec@skyward.io">amer.zec@skyward.io</a>, <a href="mailto:azec.pdx@protonmail.com">azec.pdx@protonmail.com</a> )</li>
<li>ProtonMail key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0x49AA76F7ECE2D91A.asc">0x49AA76F7ECE2D91A</a> (identity: <a href="mailto:azec.pdx@pm.me">azec.pdx@pm.me</a>)</li>
<li>ProtonMail key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0x289A688B26C7CA3A.asc">0x289A688B26C7CA3A</a> (identity: <a href="mailto:amer.zec@pm.me">amer.zec@pm.me</a>)</li>
</ul>
<p>So that is all for now. In the next post, I will try to focus on:</p>
<ol>
<li>Using GPG keys on YubiKey for signing <code>git</code> commits (and making sure they are verified on GitHub)</li>
<li>Using GPG keys on YubiKey for generating secure SSH keys for GitHub authentication, with private key material never leaving YubiKey (not being on your local machine). This is relatively new feature as of May 10th 2021 and I have been already using it for a day and I am very excited to write about it.</li>
</ol>
<p>I hope you enjoyed the read and please stop by soon!</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-04-26T22:48:55.000Z" title="4/26/2021, 3:48:55 PM">2021-04-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-11T05:12:10.170Z" title="9/10/2024, 10:12:10 PM">2024-09-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Outdoors/">Outdoors</a><span> / </span><a class="link-muted" href="/categories/Outdoors/Running/">Running</a></span><span class="level-item">7 minutes read (About 975 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/">Cape Horn Trail Run - Beyond Horses</a></h1><div class="content"><div class="justified-gallery">
<img src="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/columbia-from-capehorn-1.jpg" class title="Cape Horn - Beyond Horses - Viewpoint 1&#x2F;4">
<img src="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/columbia-from-capehorn-2.jpg" class title="Cape Horn - Beyond Horses - Viewpoint 2&#x2F;4">
<img src="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/columbia-from-capehorn-3.jpg" class title="Cape Horn - Beyond Horses - Viewpoint 3&#x2F;4">
<img src="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/columbia-from-capehorn-4.jpg" class title="Cape Horn - Beyond Horses - Viewpoint 4&#x2F;4">
</div>


<p>It is no secret that a <a target="_blank" rel="noopener" href="https://www.oregonhikers.org/field_guide/Cape_Horn_Loop_Hike">Cape Horn Loop</a> is a very popular hiking destination among Washingtonians and Oregonians. And it may have become even more popular since the beginning of COVID-19 pandemic.</p>
<p>We like it. However, it is not our top weekend hike on the Washington side of the Columbia river. I couldn’t really say we are very frequent visitors here. We try to come here for a quick hike, only if we are not in the mood to drive further east on the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Washington_State_Route_14">State Route 14</a>. There are couple other hikes that we visit more frequently on this route and I will try to blog about it some other time (I promise!).</p>
<p>One thing that we absolutely love about Cape Horn Loop though is getting to the platform with wild horses. Basically, there is a family owned farm about <code>3.2km</code> (<code>~2mi</code>) up from the trailhead. For several years this used to be our standard end of the trail. Up to the horses, enjoy seeing them and then hike back down for a total of <code>6.6km</code> (<code>~4.1mi</code>). Horses farm is at about 379m elevation and it is marked as <strong>GATE</strong> on the <a target="_blank" rel="noopener" href="https://www.fs.usda.gov/wps/PA_WIDConsumption/wid/EnlargeImage.jsp?param5=null&param1=PA_WIDConsumption&param2=FSEPRD580348&param3=Cape%20Horn%20Trail%20Map&param4=/Internet/FSE_MEDIA/fseprd580348.jpg&pname=Forest%20Service">Cape Horn Trail (#4418) vicinity map</a> (provided by the Forest Service <a target="_blank" rel="noopener" href="https://www.fs.usda.gov/recarea/crgnsa/recarea/?recid=77617">tail website</a>). If you head up there, please have in mind that feeding and petting horses is not allowed (think of the impact of each visitor trying to do that).</p>
<p>However, two weekends ago, I have decided to do something completely different. My father in-law mentioned the idea of exploring other side of the loop - which you may have already guessed, continues beyond horses. And not just hiking it, but actually trying to run it in order to hit all other remaining viewpoints. It didn’t took long to convince me and to bite to the idea. </p>
<p>So I decided to try it. And in the rest of this post, I would like to focus on what was new and exciting part for me - beyond horses. I guess I will start with first surprise. I was always under the impression that the other side of the loop is somehow more visited because it is could  also be tied to the State Route 14. But as soon as I started running from horses platform and after a little bit of gravel road, I started noticing that I may be alone for the most part. It was mostly uncrowded (especially if I compare it to number of people and cars parked at the trailhead only a weekend before). And what about things that you can see if you decide to go beyond horses, you may ask? Well, there are total of 4 viewpoints, and according to the map above, 3/4 are more known and come in this order as you are droping the elevation on the trail:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.oregonhikers.org/field_guide/Nancy_Russell_Overlook">Nancy Russell Overlook (with walled amphitheater)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oregonhikers.org/field_guide/Upper_Waterfall_Viewpoint">Upper Waterfall Viewpoint</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oregonhikers.org/field_guide/Windblown_Fir_Viewpoint">Windblown Fir Viewpoint</a></li>
</ul>
<p>I have added pictures from each to the gallery of this post. There is one more viewpoint, but it is significantly smaller and very steep and it comes after the Nancy Russell Overlook. I assume it is not much advertized as it doesn’t allow for more than 5 people to make a break and observe the view at the same time.</p>
<p>At some point I hit the sign showing that going further is prohibited. Later I learned that this is also the farthest point you can hike during peregrine falcon nesting season (February 1st to July 15th). At that point my watch was already showing <code>~6km</code> and I still had to go back. But I really liked the Windblown Fir Viewpoint and decided to take a good break there. It was really enjoyable sitting on the grass with small winds and looking down on the Columbia River. Another thing that made this break great was Lemongrass+Cherry+Matcha <a target="_blank" rel="noopener" href="https://livbar.com/">Livbar</a>. I had one that we picked up at the Portland Marathon 2019 opening at Oregon Convention Center, when my friend <a target="_blank" rel="noopener" href="https://www.portlandmarathon.com/results?pk=1657787">Irfan Šljivo</a> came up from California to run PDX Marathon. I have no idea how this bar didn’t get eaten since then, but it was amazing and I absolutely will need to order more. </p>
<p>So after the great break on that viewpoint, it was time to go back up to horses and then come down to the trailhead - returning <code>6km</code>. I was already quite tired and had only less then a half jug of water container, so I had to be more rational about hydration while returning. I made another breathing break when I reached horses again, less than 5 minutes probably. It took me 1h sharp to come back to treailhead after resting at Windblown Fir Viewpoint, for the total of <code>~12km</code>.</p>
<p>Some other stats of this run are below:</p>
<ul>
<li>Distance: <code>12.00 km</code></li>
<li>Elapsed Time: <code>2:45:53</code></li>
<li>Moving Time: <code>1:30:39</code></li>
<li>Time: <code>1:34:11</code></li>
<li>Min Elev: <code>148 m</code></li>
<li>Max Elev: <code>398 m</code></li>
<li>Calories: <code>1,154 C</code></li>
</ul>
<p>For those interested in Garmin trail of this run that you could follow, I have exported route in GPX file <a href="/2021/04/26/Cape-Horn-Trail-Run-Beyond-Horses/activity_6625084157.gpx">activity_6625084157.gpx</a> (click for download).</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-09-21T17:00:00.000Z" title="9/21/2018, 10:00:00 AM">2018-09-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-11T05:12:10.182Z" title="9/10/2024, 10:12:10 PM">2024-09-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Travel/">Travel</a></span><span class="level-item">4 minutes read (About 626 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/21/China-trip-Tiananmen-square/">China trip: Tiananmen square</a></h1><div class="content"><div class="justified-gallery">
<img src="/2018/09/21/China-trip-Tiananmen-square/tiannanmen.jpg" class title="Tiannanmen Square Map">
</div>

<p>This is the first post in the series about our vacation in China in the fall of 2018.<br>On the morning of 21st September, we got up and wandered around the street “Ju’er Hutong”<br>and the nearby suburbs of Beijing (Peking).<br>Plan for the day was to visit as much as possible around Tiananmen square.</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tiananmen_Square">Tiananmen square</a> is a city square in the centre of Beijing, China, named after the Tiananmen (“Gate of Heavenly Peace”) located to its north, separating it from the Forbidden City.</p>
<p>Since our hotel wasn’t far from public transportation, we caught a local bus (each ticket only 2 CNY/RMB) on “Jiaodaokou S St” which took us all the way to the station between gate to the Forbidden City and other monuments of Tiananmen Square (Chan’ an Ave).</p>
<p>After getting off the bus, we crossed underground tunnel to get to the other side of the Chang’ an Ave with exit next to the National Museum of China. Since I have decided to cover this museum in separate post, I will not go into too many details here. Interesting facts are that the entrance is completely free even for the foreign tourists and we spent 2h only touring one exhibition on the first floor of the west wing. The museum is so large that it could easily take a day to see all the exhibitions.</p>
<p>Our tour naturally followed towards <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Monument_to_the_People%27s_Heroes">Monument to the People’s Heroes</a> which is central monument of the Tiananmen Square. It is a ten-story obelisk that was erected as a national monument of the People’s Republic of China to the martyrs of revolutionary struggle during the 19th and 20th centuries.</p>
<p>On the west side of this monument we had a chance to see the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Great_Hall_of_the_People">Great Hall of the People</a> which is used for legislative and ceremonial activities by the government of the People’s Republic of China (PRC) and the ruling Communist Party of China (CPC).</p>
<p>Since we toured the square right before the Mid-Autumn Festival in China, there was already a lot of tourists and locals on the square and it was too busy to go inside of the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Mausoleum_of_Mao_Zedong">Mausoleum of Mao Zedong</a>. However we did take a chance to take a pictures in front of it. Mao Zedong (December 26, 1893 – September 9, 1976), commonly known as Chairman Mao, was a Chinese communist revolutionary who became the founding father of the People’s Republic of China, which he ruled as the Chairman of the Communist Party of China from its establishment in 1949 until his death in 1976.<br>Although Mao had wished to be cremated, this was ignored and his body was embalmed. The construction of a mausoleum as his final restplace began shortly after his death. This building is located in the middle of Tiananmen Square but south of the Monument to the People’s Heroes.</p>
<p>Since our goal was to explore the Forbidden City, we moved on in the north direction of the square. Before we crossed big street again, we passed by the large flower basket. These flowers are 17-meter-tall display in the shape of a flower basket at the center of the Tiananmen Square for the celebration of the National Day. It means “Good Luck, China”.</p>
<p>After taking pictures in front of the flower basket, we crossed the street and we found ourselves in front of the large gate that provides entrance to the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Forbidden_City">Forbidden City</a>, which I will cover in another post.</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/squared.jpg" alt="azec.me"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">azec.me</p><p class="is-size-6 is-block">Engineering &amp; Outdoors</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>WA, USA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">23</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/azec-pdx/" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/azec-pdx"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="StackOverflow" href="https://stackoverflow.com/users/126382/azec-pdx"><i class="fab fa-stack-overflow"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/azec-pdx"><i class="fab fa-linkedin-in"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Strava" href="https://www.strava.com/athletes/143126037"><i class="fab fa-strava"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="E-Mail" href="mailto:amerzec+jobs@gmail.com"><i class="far fa-envelope-open"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://azec.me/atom.xml" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Atom Feed</span></span><span class="level-right"><span class="level-item tag">azec.me</span></span></a></li><li><a class="level is-mobile" href="https://azec.me/rss2.xml" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">RSS Feed</span></span><span class="level-right"><span class="level-item tag">azec.me</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Outdoors/"><span class="level-start"><span class="level-item">Outdoors</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Outdoors/Running/"><span class="level-start"><span class="level-item">Running</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Software/Containers/"><span class="level-start"><span class="level-item">Containers</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/Security/"><span class="level-start"><span class="level-item">Security</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Tools/"><span class="level-start"><span class="level-item">Tools</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tools/Productivity/"><span class="level-start"><span class="level-item">Productivity</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Travel/"><span class="level-start"><span class="level-item">Travel</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/"><img src="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/podman_logo.png" alt="Docker CLI and API version (in)compatibility with Podman Engine"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-01-25T06:22:19.000Z">2026-01-24</time></p><p class="title"><a href="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/">Docker CLI and API version (in)compatibility with Podman Engine</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Containers/">Containers</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2026/01/24/Using-Podman-with-GPU-intensive-containers/"><img src="/2026/01/24/Using-Podman-with-GPU-intensive-containers/containers.png" alt="Using Podman with GPU intensive containers"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-01-24T21:42:52.000Z">2026-01-24</time></p><p class="title"><a href="/2026/01/24/Using-Podman-with-GPU-intensive-containers/">Using Podman with GPU intensive containers</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Containers/">Containers</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/"><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/toolbox.png" alt="Favorite PDF tools on macOS in 2026"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-11-26T20:57:56.000Z">2025-11-26</time></p><p class="title"><a href="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/">Favorite PDF tools on macOS in 2026</a></p><p class="categories"><a href="/categories/Tools/">Tools</a> / <a href="/categories/Tools/Productivity/">Productivity</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/11/Using-YubiKey-with-GitHub/"><img src="/2021/05/11/Using-YubiKey-with-GitHub/yubikey-and-github.png" alt="Using YubiKey with GitHub"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-11T15:01:00.000Z">2021-05-11</time></p><p class="title"><a href="/2021/05/11/Using-YubiKey-with-GitHub/">Using YubiKey with GitHub</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Security/">Security</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/"><img src="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/yubikey-and-keybase-and-proton.png" alt="PGP with YubiKey &amp; Keybase &amp; Protonmail"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-11T01:30:40.000Z">2021-05-10</time></p><p class="title"><a href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/">PGP with YubiKey &amp; Keybase &amp; Protonmail</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Security/">Security</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2026/01/"><span class="level-start"><span class="level-item">January 2026</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/11/"><span class="level-start"><span class="level-item">November 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Asia/"><span class="tag">Asia</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/China/"><span class="tag">China</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Columbia-Gorge/"><span class="tag">Columbia Gorge</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Containers/"><span class="tag">Containers</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Encryption/"><span class="tag">Encryption</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FOSS/"><span class="tag">FOSS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG/"><span class="tag">GPG</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GitHub/"><span class="tag">GitHub</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Keybase/"><span class="tag">Keybase</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PDF/"><span class="tag">PDF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PDX/"><span class="tag">PDX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PGP/"><span class="tag">PGP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Podman/"><span class="tag">Podman</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Privacy/"><span class="tag">Privacy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ProtonMail/"><span class="tag">ProtonMail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reading/"><span class="tag">Reading</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Running/"><span class="tag">Running</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vacation/"><span class="tag">Vacation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/YubiKey/"><span class="tag">YubiKey</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tools/"><span class="tag">tools</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=azec-pdx&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="azec-pdx" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon-512.png" alt="azec.me | Blog by Amer Zec" height="28"></a><p class="is-size-7"><span>&copy; 2026 Amer Zec</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Resume WWW" href="https://azec.me/resume"><i class="far fa-file-alt"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Resume PDF" href="https://drive.google.com/file/d/1pdSW7W3bCS5znq1JDkjQ68YqimQXhM1d/view?usp=sharing"><i class="far fa-file-pdf"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="E-Mail" href="mailto:amerzec+jobs@gmail.com"><i class="far fa-envelope"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>