<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Tag: ProtonMail - azec.me | Blog by Amer Zec</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="azec.me | Blog by Amer Zec"><meta name="msapplication-TileImage" content="/img/favicon-128.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="azec.me | Blog by Amer Zec"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Engineering, outdoors, and technology insights by Amer Zec"><meta property="og:type" content="blog"><meta property="og:title" content="azec.me | Blog by Amer Zec"><meta property="og:url" content="https://azec.me/"><meta property="og:site_name" content="azec.me"><meta property="og:description" content="Engineering, outdoors, and technology insights by Amer Zec"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://azec.me/img/stenciler.jpg"><meta property="article:author" content="Amer Zec"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://azec.me/img/stenciler.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://azec.me"},"headline":"azec.me | Blog by Amer Zec","image":["https://azec.me/img/stenciler.jpg"],"author":{"@type":"Person","name":"Amer Zec"},"publisher":{"@type":"Organization","name":"azec.me | Blog by Amer Zec","logo":{"@type":"ImageObject","url":"https://azec.me/img/favicon-512.png"}},"description":"Engineering, outdoors, and technology insights by Amer Zec"}</script><link rel="alternate" href="/atom.xml" title="azec.me | Blog by Amer Zec" type="application/atom+xml"><link rel="icon" href="/img/favicon-128.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link id="hljs-light-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/atom-one-light.css"><link id="hljs-dark-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/monokai.css"><script>(function(){try{var settings={"storageKey":"azec-color-scheme","defaultScheme":"auto","prefersColorScheme":true};var docEl=document.documentElement;if(!docEl||!settings){return;}var stored=null;try{stored=localStorage.getItem(settings.storageKey);}catch(e){}var scheme=stored||settings.defaultScheme||'light';var prefers=settings.prefersColorScheme!==false;var media=prefers&&window.matchMedia?window.matchMedia('(prefers-color-scheme: dark)'):null;if(scheme==='auto'&&media){scheme=media.matches?'dark':'light';}if(scheme!=='dark'&&scheme!=='light'){scheme='light';}docEl.dataset.theme=scheme;docEl.classList.remove('theme-light','theme-dark');docEl.classList.add('theme-'+scheme);var body=document.body;if(body){body.classList.remove('theme-light','theme-dark');body.classList.add('theme-'+scheme);}var lightLink=document.getElementById('hljs-light-theme');var darkLink=document.getElementById('hljs-dark-theme');if(lightLink&&darkLink){if(scheme==='dark'){lightLink.setAttribute('disabled','disabled');darkLink.removeAttribute('disabled');}else{darkLink.setAttribute('disabled','disabled');lightLink.removeAttribute('disabled');}}}catch(e){}})();</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon-512.png" alt="azec.me | Blog by Amer Zec" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><button class="navbar-item navbar-theme-toggle" type="button" title="Toggle color scheme" aria-label="Toggle color scheme" aria-pressed="false"><i class="fas fa-moon"></i><i class="fas fa-sun"></i></button></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags/">Tags</a></li><li class="is-active"><a href="#" aria-current="page">ProtonMail</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-05-11T01:30:40.000Z" title="5/10/2021, 6:30:40 PM">2021-05-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-09-11T05:12:10.183Z" title="9/10/2024, 10:12:10 PM">2024-09-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Software/">Software</a><span> / </span><a class="link-muted" href="/categories/Software/Security/">Security</a></span><span class="level-item">17 minutes read (About 2577 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/">PGP with YubiKey &amp; Keybase &amp; Protonmail</a></p><div class="content"><p><strong>TABLE OF CONTENTS</strong></p>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#intro-to-yubikey-and-generating-gpg-keys">Intro to YubiKey and generating GPG keys</a></li>
<li><a href="#using-gpg-keys-managed-by-yubikey-with-keybase">Using GPG keys (managed by YubiKey) with Keybase</a></li>
<li><a href="#using-gpg-keys-managed-by-yubikey-with-protonmail">Using GPG keys (managed by YubiKey) with ProtonMail</a></li>
</ul>
<!-- tocstop -->

</div>
<hr>

<h3><a href="#intro-to-yubikey-and-generating-gpg-keys" class="header-anchor">✎</a><span id="intro-to-yubikey-and-generating-gpg-keys">Intro to YubiKey and generating GPG keys</span></h3><p>It has been a good few months since I started playing with and using <a target="_blank" rel="noopener" href="https://www.yubico.com/product/yubikey-5ci/">YubiKey 5ci</a>.<br>So far I haven’t really used it for anything more serious, at least not until I learn enough about its capabilities, as well as how to use it together with <code>gpg</code> suite.</p>
<p>YubiKey 5Ci truly is the first of its kind.<br>Of all the features you can read about on the product page I would just mention these:</p>
<ul>
<li><strong>Function:</strong> WebAuthn, FIDO2 CTAP1, FIDO2 CTAP2, Universal 2nd Factor (U2F), Smart card (PIV-compatible), Yubico OTP, OATH – HOTP (Event), OATH – TOTP (Time), Open PGP, Secure Static Password</li>
<li><strong>Cryptographic Specifications:</strong> RSA 2048, RSA 4096 (PGP), ECC p256, ECC p384</li>
<li><strong>Certifications:</strong> FIDO 2 Certified, FIDO Universal 2nd Factor (U2F) Certified</li>
<li><strong>Device Type:</strong> FIDO HID Device, CCID Smart Card, HID Keyboard</li>
</ul>
<p>It is also worth mentioning that it has good support from password managers.<br>Basically, you can use it as 2nd factor authentication device in two ways:</p>
<ol>
<li><p>By using it <strong>as virtual MFA device</strong>. For this to work you need the device plugged into one of your mobile/desktop (physical) devices and <a target="_blank" rel="noopener" href="https://www.yubico.com/products/yubico-authenticator/">Yubico Authenticator</a> app/client for one of the supported OSes.</p>
</li>
<li><p>By using it as <strong>FIDO U2F device</strong>. For those that are new to this, here is what it means:</p>
<blockquote>
<p>U2F is an open authentication standard that enables internet users to securely access any number of online services with one single security key instantly and with no drivers or client software needed.</p>
</blockquote>
<p>You can read more about this feature <a target="_blank" rel="noopener" href="https://www.yubico.com/authentication-standards/fido-u2f/">on the product page</a>.<br>Basically the device comes equipped with two pins (one on each side) that you need to press when prompted for 2nd factor key from services that support this standard. On the press of those keys, device generates series of keystrokes that are verified by service provider, in similar fashion how OTP tokens are generated in the 1st option above.</p>
</li>
</ol>
<p>It may have caught your attention but if it did not - this device also can behave as a Smart Card and offers Open PGP functionality. What this means is that you can use it to manage your GPG keys in multiple ways. And that is exactly what I want to focus on in this post, with emphasis on my use-cases:</p>
<ol>
<li>Using GPG keys managed by YubiKey with Keybase</li>
<li>Using GPG keys managed by YubiKey with ProtonMail</li>
<li><em>IDEALLY</em> - Using just single GPG key managed by YubiKey for both Keybase and ProtonMail</li>
</ol>
<p>First and probably most important thing to know (which you could guess, I didn’t know when I started experimenting) is that with posession of security key (YubiKey), users have two strategies how to manage GPG keys:</p>
<ol>
<li>Generating Keys externally from the YubiKey</li>
<li>Generating Your PGP Key directly on Your YubiKey</li>
</ol>
<p>Both of the above methods have pros and cons:</p>
<p><strong>Pros:</strong></p>
<ul>
<li>1st method provides opportunity to backup GPG keys elsewhere</li>
<li>2nd method (generating the PGP on the YubiKey) ensures that malware can never steal your PGP private key</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>1st method - it is strongly recommended that you to generate keys on an offline system</li>
<li>2nd method - it means that the key can not be backed up so if your YubiKey is lost or damaged the PGP key is irrecoverable</li>
</ul>
<p>However, of the two methods above, the first one is strongly recommended (by YubiKey) because 1st method provides opportunity of “safely” backup GPG keys (in sume durable form - either paper or other electronic form), at least according to the official article <em><a target="_blank" rel="noopener" href="https://support.yubico.com/hc/en-us/articles/360013790259-Using-Your-YubiKey-with-OpenPGP">Using Your YubiKey with OpenPGP</a></em>. You can find more details about proceedure for generating GPG keys for both strategies on that page.</p>
<p>As far as my keys are concerned, I have followed another (by now very famous guide) at <a target="_blank" rel="noopener" href="https://github.com/drduh/YubiKey-Guide">drduh/YubiKey-Guide</a>.</p>
<p>The process is pretty straightforward and eventually I ended up with 1 master key and 3 subkeys (one for signing, one for encryption and one for authentication):</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; gpg -K --keyid-format LONG</span><br><span class="line"></span><br><span class="line">/Users/amer/.gnupg/pubring.kbx</span><br><span class="line">------------------------------</span><br><span class="line">sec#  rsa4096/F2036890CCE43A6E 2020-12-15 [C]</span><br><span class="line">      Key fingerprint = 87DE DBA3 6B74 59EB A9DB  60D4 F203 6890 CCE4 3A6E</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@pm.me&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amerzec@gmail.com&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;amer.zec@skyward.io&gt;</span><br><span class="line">uid                 [ultimate] Amer Zec &lt;azec.pdx@protonmail.com&gt;</span><br><span class="line">ssb&gt;  rsa4096/C7C4CE019E24528B 2020-12-15 [S] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/337469C332E23BC2 2020-12-15 [E] [expires: 2031-05-04]</span><br><span class="line">ssb&gt;  rsa4096/AF7288986C0C508B 2020-12-15 [A] [expires: 2031-05-04]</span><br></pre></td></tr></table></figure>

<p>Next, I wanted to explore how can I use this key with Keybase.</p>
<h3><a href="#using-gpg-keys-managed-by-yubikey-with-keybase" class="header-anchor">✎</a><span id="using-gpg-keys-managed-by-yubikey-with-keybase">Using GPG keys (managed by YubiKey) with Keybase</span></h3><p>Keybase comes with variety of options for PGP in its CLI subcommand <code>keybase pgp [OPTIONS]</code>. The ones most relevant for our topic here are:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select	Select a key from GnuPG as your own and register the public half with Keybase</span><br><span class="line">import	Import a PGP key into keybase</span><br><span class="line">drop		Drop Keybase&#x27;s use of a PGP key</span><br><span class="line">list		List the active PGP keys in your account.</span><br></pre></td></tr></table></figure>

<p>If you had any previously generated (and/or managed by Keybase) GPG keys, I recommend that you use <code>drop</code> option to drop them. This was certainly my case, as I was only interested in adding to the Keybase my public GPG key, specifically the one managed by YubiKey, so that other users on this network can use it to encrypt messages to me via <a target="_blank" rel="noopener" href="https://keybase.io/azec#_">Keybase Chat</a>. </p>
<p>Now to the hard part. There are two very similar but somewhat confusing ways to add your GPG key to Keybase. Using <code>select</code> or using <code>import</code> subcommand listed above. In this step, it really depends what you want to do.<br>As I said earlier, my interest WAS NOT to have Keybase keyring managing any secret/private part of my GPG keys. So I had to read carefully what each of these subcommands does. And for posterity, here is the the gist of each:</p>
<ul>
<li><p>The <code>import</code> subcommand</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line">keybase pgp import [command options]</span><br><span class="line"></span><br><span class="line">DESCRIPTION:</span><br><span class="line">&quot;keybase pgp import&quot; imports a PGP secret key for use with Keybase.</span><br><span class="line">It accepts that secret key via file (with the &quot;--infile&quot; flag) or</span><br><span class="line">otherwise via standard input. The secret key is used to sign the</span><br><span class="line">public PGP key into the user&#x27;s Keybase sigchain. The secret key</span><br><span class="line">is also imported into the local Keybase keyring and encrypted with</span><br><span class="line">the local key security protocol.</span><br><span class="line"></span><br><span class="line">If (and only if) the &quot;--push-secret&quot; flag is specified, this command</span><br><span class="line">pushes the PGP secret key to the Keybase server, encrypted with the</span><br><span class="line">user&#x27;s passphrase. The server, in this case, could theoretically</span><br><span class="line">recover the PGP secret key by cracking the user&#x27;s passphrase.</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">-i, --infile 	Specify an infile (stdin by default).</span><br><span class="line">--push-secret	Push an encrypted copy of the secret key to the server.</span><br></pre></td></tr></table></figure>
<p>  As I have already stated twice, my case was not to import secret key to local Keybase keyring and neither was it to push secret key to Keybase server.<br>  So I completely skipped this subcommand.</p>
</li>
<li><p>The <code>select</code> subcommand</p>
  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line">keybase pgp select [command options] [key query]</span><br><span class="line"></span><br><span class="line">DESCRIPTION:</span><br><span class="line">&quot;keybase pgp select&quot; looks at the local GnuPG keychain for all</span><br><span class="line">available secret keys. It then makes those keys available for use with keybase.</span><br><span class="line">The steps involved are: (1a) sign a signature chain link with the selected PGP</span><br><span class="line">key and the existing device key; (1b) push this signature and the public PGP</span><br><span class="line">key to the server; and if &quot;--import&quot; flag is passed: (2a) copy the PGP secret half</span><br><span class="line">into your local Keybase keyring; and (2b) encrypt this secret key with Keybase&#x27;s</span><br><span class="line">local key security mechanism.</span><br><span class="line"></span><br><span class="line">By default, Keybase suggests only one PGP public key, but if you want to,</span><br><span class="line">you can supply the &quot;--multi&quot; flag to override this restriction. If you</span><br><span class="line">want your secret key imported into the local Keybase keyring, then use</span><br><span class="line">the &quot;--import&quot; flag. Importing your secret key to Keybase keyring makes</span><br><span class="line">it possible to use Keybase PGP commands like &quot;pgp decrypt&quot; or &quot;pgp sign&quot;.</span><br><span class="line"></span><br><span class="line">If you don&#x27;t want to publish signature chain link to Keybase servers, use</span><br><span class="line">&quot;--no-publish&quot; flag. It&#x27;s only valid when both &quot;--no-publish&quot; and &quot;--import&quot;</span><br><span class="line">flags are used.</span><br><span class="line"></span><br><span class="line">This operation will never push your secret key, encrypted or otherwise,</span><br><span class="line">to the Keybase server.</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">--multi	Allow multiple PGP keys.</span><br><span class="line">--import	Import private key to the local Keybase keyring.</span><br><span class="line">--no-publish	Only import to Keybase keyring, do not publish on user profile.</span><br></pre></td></tr></table></figure>

<p>  As described, this command provides a way of selecting multiple GPG keys from local GPG keyring and then making them available for use with Keybase. So basically, this is all I needed (minus all the fancy stuff).</p>
</li>
</ul>
<p>So to finalize this section, I have done following to make my public GPG key available to Keybase:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; keybase pgp select --multi</span><br><span class="line"></span><br><span class="line">You are selecting a PGP key from your local GnuPG keychain, and</span><br><span class="line">will publish a statement signed with this key to make it part of</span><br><span class="line">your Keybase.io identity.</span><br><span class="line"></span><br><span class="line">Note that GnuPG will prompt you to perform this signature.</span><br><span class="line"></span><br><span class="line">You can also import the secret key to *local*, *encrypted* Keybase</span><br><span class="line">keyring, enabling decryption and signing with the Keybase client.</span><br><span class="line">To do that, use &quot;--import&quot; flag.</span><br><span class="line"></span><br><span class="line">Learn more: keybase pgp help select</span><br><span class="line"></span><br><span class="line">#    Algo    Key Id             Created   UserId</span><br><span class="line">=    ====    ======             =======   ======</span><br><span class="line">1    4096R   F2036890CCE43A6E             Amer Zec &lt;amer.zec@pm.me&gt;, Amer Zec &lt;azec.pdx@pm.me&gt;, Amer Zec &lt;amerzec@gmail.com&gt;, Amer Zec &lt;amer.zec@skyward.io&gt;, Amer Zec &lt;azec.pdx@protonmail.com&gt;</span><br><span class="line">Choose a key:</span><br></pre></td></tr></table></figure>

<p>After selecting the only option available (<code>1</code>) my key showed up as verified and published on Keybase <a target="_blank" rel="noopener" href="https://keybase.io/azec/pgp_keys.asc?fingerprint=87dedba36b7459eba9db60d4f2036890cce43a6e">0xF2036890CCE43A6E</a>. Notice that I did not pass <code>--import</code> flag to the above command, as I am not interested in the Keybase CLI features such as <code>keybase pgp decrypt</code> and <code>keybase pgp sign</code>. </p>
<p>Next, I wanted to explore how can I use this same GPG key with ProtonMail.</p>
<h3><a href="#using-gpg-keys-managed-by-yubikey-with-protonmail" class="header-anchor">✎</a><span id="using-gpg-keys-managed-by-yubikey-with-protonmail">Using GPG keys (managed by YubiKey) with ProtonMail</span></h3><p>Now, in the interest of saving you time - I will state it upfront, this is actually not possible. If you are interested in knowing more about why, read on.</p>
<p>So one thing about ProtonMail is that their UI provides users with opportunity to generate new PGP keys. This is all well described in their <a target="_blank" rel="noopener" href="https://protonmail.com/support/knowledge-base/how-to-use-pgp/">How to use PGP</a> article.<br>And for quite some time, I have had separate keys that vere completely managed by ProtonMail. By managed, I mean, that keys were generated on ProtonMail and never ever exported elsewhere to any external system. While ProtonMail allows exporting both public and private GPG keys generated by their UI, I never had interest in doing so. </p>
<p>Also, I didn’t have a need to generate ProtonMail GPG keys externally and import them (another ProtonMail feature), until now. I was on the happy path following these steps:</p>
<ol>
<li>I have analyzed keys (by importing them to local GPG keyring) that were managed by ProtonMail to see what capabilities they have. I noted that they generate 1 subkey which has both <code>[SC]</code> capabilities. I also noted that this is not the case with any of my subkeys generated with YubiKey and started wondering if this will be causing any issues when I try to import YubiKey-managed keys.</li>
<li>I completely deleted my GPG keys managed by ProtonMail from their UI attached to one of my e-mail identities of interest. I also deleted them from the local GPG keyring.</li>
<li>(please do this with caution), I have obtained my YubiKeys backup, and tried to import subkeys private key + public key to ProtonMail. Everything was smooth until it prompted me for private key passphrase. However with 100% certainty that I am entering correct passphrase, it kept re-prompting me endlessly to enter it again. At this point I knew there is something wrong and decided to stop here.</li>
</ol>
<p>After being blocked on step 3. I have decided to reach out to ProtonMail support and describe my case. Here is the gist of my ask and their follow-up.</p>
<p><em>me:</em> </p>
<pre><code>Timestamp: 1620182869

Hi there,

I am trying to consolidate my GPG subkeys managed with YubiKey and my GPG keys imported in ProtonMail. Originally I was generating private/public key from within ProtonMail - one for each of my ProtonMail identities and when I export them and import them to my GPG ring they show following:

pub rsa4096 2019-03-14 [SC]
766B78E832154AD500656D3B289A688B26C7CA3A
uid [ unknown] amer.zec@pm.me &lt;amer.zec@pm.me&gt;
sub rsa4096 2019-03-14 [E]

pub rsa4096 2021-04-25 [SC]
9C2BEC2FB2A1289237BCDA0349AA76F7ECE2D91A
uid [ unknown] azec.pdx@pm.me &lt;azec.pdx@pm.me&gt;
sub rsa4096 2021-04-25 [E]

However, since I started using YubiKey I have this setup:
1 master key with C capability
1 subkey with S capability
1 subkey with E capability
1 subkey with A capability

and all my ProtonMail and other e-mail identities are added to the master key.

So I am curious if there is a way for me to discard above keys that originated by ProtonMail and import some combination of subkeys that I manage with YubiKey? If so, would the capabilities of my existing keys be sufficient, or I would have to create additional subkeys just for ProtonMail use?

Thanks!</code></pre><p><em>ProtonMail support:</em></p>
<pre><code>Hello,

Thank you for contacting ProtonMail support.

Unfortunately, importing subkeys without the master key is not supported. In the GPG documentation, you can see that &quot;this is a GNU extension to OpenPGP and other implementations cannot be expected to successfully import such a key.&quot;
https://www.gnupg.org/documentation/manpage.html

Our documentation on using PGP can be found in this article:
https://protonmail.com/support/knowledge-base/how-to-use-pgp/

Feel free to get back to us with any additional questions or concerns. Our team remains available if needed. 
Kind regards,
Ivana

Customer Support
ProtonMail</code></pre><p>So while the quick follow up kicked in with joy once I saw the e-mail, it was pretty disappointing to learn that ProtonMail doesn’t support importing subkeys. And for me, importing my master secret key (after moving it to YubiKey secure card) was not an option. </p>
<p>As an alternative, I have decided to use separate ProtonMail managed pair of GPG keys, as listed below (links lead to public key hosted on my website):</p>
<ul>
<li>Main GPG (YubiKey managed) &amp; Keybase key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0xF2036890CCE43A6E.asc">0xF2036890CCE43A6E</a> (identities on key: <a href="mailto:amer.zec@pm.me">amer.zec@pm.me</a>, <a href="mailto:azec.pdx@pm.me">azec.pdx@pm.me</a>, <a href="mailto:amerzec@gmail.com">amerzec@gmail.com</a>, <a href="mailto:amer.zec@skyward.io">amer.zec@skyward.io</a>, <a href="mailto:azec.pdx@protonmail.com">azec.pdx@protonmail.com</a> )</li>
<li>ProtonMail key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0x49AA76F7ECE2D91A.asc">0x49AA76F7ECE2D91A</a> (identity: <a href="mailto:azec.pdx@pm.me">azec.pdx@pm.me</a>)</li>
<li>ProtonMail key <a target="_blank" rel="noopener" href="http://azec-pdx.me/gpg-0x289A688B26C7CA3A.asc">0x289A688B26C7CA3A</a> (identity: <a href="mailto:amer.zec@pm.me">amer.zec@pm.me</a>)</li>
</ul>
<p>So that is all for now. In the next post, I will try to focus on:</p>
<ol>
<li>Using GPG keys on YubiKey for signing <code>git</code> commits (and making sure they are verified on GitHub)</li>
<li>Using GPG keys on YubiKey for generating secure SSH keys for GitHub authentication, with private key material never leaving YubiKey (not being on your local machine). This is relatively new feature as of May 10th 2021 and I have been already using it for a day and I am very excited to write about it.</li>
</ol>
<p>I hope you enjoyed the read and please stop by soon!</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/squared.jpg" alt="azec.me"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">azec.me</p><p class="is-size-6 is-block">Engineering &amp; Outdoors</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>WA, USA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives/"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories/"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags/"><p class="title">23</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/azec-pdx/" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/azec-pdx"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Stack Overflow" href="https://stackoverflow.com/users/126382/azec-pdx"><i class="fab fa-stack-overflow"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="LinkedIn" href="https://www.linkedin.com/in/azec-pdx"><i class="fab fa-linkedin-in"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Strava" href="https://www.strava.com/athletes/143126037"><i class="fab fa-strava"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Add me on Discord!" href="https://discord.com/users/1045128734975463456"><i class="fab fa-discord"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="GPG Keys" href="https://azec.me/about/"><i class="fas fa-key"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://azec.me/atom.xml" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Atom Feed</span></span><span class="level-right"><span class="level-item tag">azec.me</span></span></a></li><li><a class="level is-mobile" href="https://azec.me/rss2.xml" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">RSS Feed</span></span><span class="level-right"><span class="level-item tag">azec.me</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Outdoors/"><span class="level-start"><span class="level-item">Outdoors</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Outdoors/Running/"><span class="level-start"><span class="level-item">Running</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Software/Containers/"><span class="level-start"><span class="level-item">Containers</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/Security/"><span class="level-start"><span class="level-item">Security</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Tools/"><span class="level-start"><span class="level-item">Tools</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tools/Productivity/"><span class="level-start"><span class="level-item">Productivity</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Travel/"><span class="level-start"><span class="level-item">Travel</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/"><img src="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/podman_logo.png" alt="Docker CLI and API version (in)compatibility with Podman Engine"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-01-25T06:22:19.000Z">2026-01-24</time></p><p class="title"><a href="/2026/01/24/Docker-CLI-API-version-compatibility-with-Podman-engine/">Docker CLI and API version (in)compatibility with Podman Engine</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Containers/">Containers</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2026/01/24/Using-Podman-with-GPU-intensive-containers/"><img src="/2026/01/24/Using-Podman-with-GPU-intensive-containers/containers.png" alt="Using Podman with GPU intensive containers"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-01-24T21:42:52.000Z">2026-01-24</time></p><p class="title"><a href="/2026/01/24/Using-Podman-with-GPU-intensive-containers/">Using Podman with GPU intensive containers</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Containers/">Containers</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/"><img src="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/toolbox.png" alt="Favorite PDF tools on macOS in 2026"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-11-26T20:57:56.000Z">2025-11-26</time></p><p class="title"><a href="/2025/11/26/Favorite-PDF-tools-on-macOS-in-2026/">Favorite PDF tools on macOS in 2026</a></p><p class="categories"><a href="/categories/Tools/">Tools</a> / <a href="/categories/Tools/Productivity/">Productivity</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/11/Using-YubiKey-with-GitHub/"><img src="/2021/05/11/Using-YubiKey-with-GitHub/yubikey-and-github.png" alt="Using YubiKey with GitHub"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-11T15:01:00.000Z">2021-05-11</time></p><p class="title"><a href="/2021/05/11/Using-YubiKey-with-GitHub/">Using YubiKey with GitHub</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Security/">Security</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/"><img src="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/yubikey-and-keybase-and-proton.png" alt="PGP with YubiKey &amp; Keybase &amp; Protonmail"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-11T01:30:40.000Z">2021-05-10</time></p><p class="title"><a href="/2021/05/10/PGP-with-YubiKey-Keybase-Protonmail/">PGP with YubiKey &amp; Keybase &amp; Protonmail</a></p><p class="categories"><a href="/categories/Software/">Software</a> / <a href="/categories/Software/Security/">Security</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2026/01/"><span class="level-start"><span class="level-item">January 2026</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/11/"><span class="level-start"><span class="level-item">November 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Asia/"><span class="tag">Asia</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/China/"><span class="tag">China</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Columbia-Gorge/"><span class="tag">Columbia Gorge</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Containers/"><span class="tag">Containers</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Encryption/"><span class="tag">Encryption</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FOSS/"><span class="tag">FOSS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPG/"><span class="tag">GPG</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GitHub/"><span class="tag">GitHub</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Keybase/"><span class="tag">Keybase</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PDF/"><span class="tag">PDF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PDX/"><span class="tag">PDX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PGP/"><span class="tag">PGP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Podman/"><span class="tag">Podman</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Privacy/"><span class="tag">Privacy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ProtonMail/"><span class="tag">ProtonMail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reading/"><span class="tag">Reading</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Running/"><span class="tag">Running</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vacation/"><span class="tag">Vacation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/YubiKey/"><span class="tag">YubiKey</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tools/"><span class="tag">tools</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=azec-pdx&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="azec-pdx" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon-512.png" alt="azec.me | Blog by Amer Zec" height="28"></a><p class="is-size-7"><span>&copy; 2026 Amer Zec</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="E-Mail" href="mailto:amerzec+jobs@gmail.com"><i class="far fa-envelope"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {"article":{"highlight":{"clipboard":true,"fold":"unfolded"}},"appearance":{"enable":true,"defaultScheme":"auto","storageKey":"azec-color-scheme","prefersColorScheme":true,"lightHighlight":"atom-one-light","darkHighlight":"monokai"}};</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>